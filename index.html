
<!DOCTYPE HTML>
<html>
<head>
	<meta charset="utf-8">
	<title>木頭人 - 宇騰</title>
	<meta name="author" content="Yutang Chung">

	
	<meta name="description" content="前言 这次的制作其实是计算机图形学的作业，也是我第一次接触OpenGL，一个星期从零开始学习OpenGL并制作虚拟人走动模型。 代码托管于GitHub的HumanWalking。 目标 虚拟的类人形模型
可以自由走动
完全使用OpenGL实现
可以控制人的走动方向
可以控制视角方向 从主函数开始 &hellip;">
	
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

	<link href="/atom.xml" rel="alternate" title="木頭人 - 宇騰" type="application/atom+xml">
	<link rel="canonical" href="">
	<link href="/favicon.png" rel="shortcut icon">
	<link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
	<!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
	<script src="//ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
	<link href='http://fonts.googleapis.com/css?family=Open+Sans:400italic,400,700' rel='stylesheet' type='text/css'>
	
</head>

<body>
	<div class="container">
		<div class="left-col">
			<header id="header" class="inner"><div class="profilepic">	
	<img src="/images/dp.jpg" alt="Profile Picture" style="width: 160px;">
</div>
<h1><a href="/">木頭人 - 宇騰</a></h1>
<nav id="main-nav"><ul class="main">
	<li><a href="/">Blog</a></li>
	<li><a href="/blog/archives">Archives</a></li>
</ul>
</nav>
<br/>
<h3 class="alignleft">汇聚在学习中遇到的问题，感受解决问题带来的快乐</h3>
<nav id="sub-nav" class="alignright">
	<div class="social">
		
		
		<a class="google" href="https://plus.google.com/zonyitoo?rel=author" title="Google+">Google+</a>
		
		
		<a class="twitter" href="http://twitter.com/zonyitoo" title="Twitter">Twitter</a>
		
		
		<a class="github" href="https://github.com/Zonyitoo" title="GitHub">GitHub</a>
		
		
		
		
		
		<a class="rss" href="/atom.xml" title="RSS">RSS</a>
		
	</div>
</nav>

</header>
		</div>		
		<div class="mid-col">
			
				
<div id="banner" class="inner">
	<div class="container">
		<ul class="feed"></ul>
	</div>
	<small><a href="http://twitter.com/zonyitoo">zonyitoo</a> @ <a href="http://twitter.com">Twitter</a></small>
	<div class="loading">Loading...</div>
</div>
<script src="/javascripts/twitter.js"></script>
<script type="text/javascript">
	(function($){
		$('#banner').getTwitterFeed('zonyitoo', 4, false);
	})(jQuery);
</script>

			
			<div class="mid-col-container">
				<div id="content" class="inner">


    <article class="post">
	<div class="meta">
		<div class="date">








  


<time datetime="2012-11-18T18:12:00+08:00" pubdate data-updated="true">Nov 18<span>th</span>, 2012</time></div>
		<div class="tags">


	<a class='category' href='/blog/categories/computergraphics/'>ComputerGraphics</a>, <a class='category' href='/blog/categories/opengl/'>OpenGL</a>


</div>
		
			<span class="comments"><a href="/blog/2012/11/18/openglzhi-zuo-xu-ni-ren-yun-dong//index.html#disqus_thread">Comments</a></span>
		
	</div>
	<h1 class="title"><a href="/blog/2012/11/18/openglzhi-zuo-xu-ni-ren-yun-dong/">OpenGL制作虚拟人运动</a></h1>
	<div class="entry-content">
		<h1>前言</h1>

<p>这次的制作其实是计算机图形学的作业，也是我第一次接触OpenGL，一个星期从零开始学习OpenGL并制作虚拟人走动模型。</p>

<p>代码托管于GitHub的<a href="https://github.com/zonyitoo/HumanWalking">HumanWalking</a>。</p>

<h2>目标</h2>

<ul>
<li>虚拟的类人形模型</li>
<li>可以自由走动</li>
<li>完全使用OpenGL实现</li>
<li>可以控制人的走动方向</li>
<li>可以控制视角方向</li>
</ul>


<h1>从主函数开始</h1>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
</pre></td><td class='code'><pre><code class='cpp'><span class='line'><span class="kt">int</span> <span class="n">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span> <span class="o">**</span><span class="n">argv</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="n">glutInit</span><span class="p">(</span><span class="o">&amp;</span><span class="n">argc</span><span class="p">,</span> <span class="n">argv</span><span class="p">);</span>
</span><span class='line'>    <span class="n">glutInitDisplayMode</span><span class="p">(</span><span class="n">GLUT_DOUBLE</span> <span class="o">|</span> <span class="n">GLUT_RGB</span> <span class="o">|</span> <span class="n">GLUT_DEPTH</span><span class="p">);</span>
</span><span class='line'>    <span class="n">glutInitWindowSize</span><span class="p">(</span><span class="mi">500</span><span class="p">,</span> <span class="mi">500</span><span class="p">);</span>
</span><span class='line'>    <span class="n">glutInitWindowPosition</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">);</span>
</span><span class='line'>    <span class="n">glutCreateWindow</span><span class="p">(</span><span class="n">argv</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
</span><span class='line'>    <span class="n">init</span><span class="p">();</span>
</span><span class='line'>    <span class="n">glutDisplayFunc</span><span class="p">(</span><span class="n">display</span><span class="p">);</span>
</span><span class='line'>    <span class="n">glutReshapeFunc</span><span class="p">(</span><span class="n">reshape</span><span class="p">);</span>
</span><span class='line'>    <span class="n">glutKeyboardFunc</span><span class="p">(</span><span class="n">keyboard</span><span class="p">);</span>
</span><span class='line'>    <span class="n">glutPassiveMotionFunc</span><span class="p">(</span><span class="n">passiveMotionFunc</span><span class="p">);</span>
</span><span class='line'>    <span class="n">calculateData</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span><span class='line'>    <span class="n">glutMainLoop</span><span class="p">();</span>
</span><span class='line'>    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<ul>
<li><p>先调用<code>glutInit</code>函数初始化OpenGL环境</p></li>
<li><p>设定OpenGL的显示模式，在这里启动了<code>GLUT_DOUBLE</code>双缓冲、<code>GLUT_RGB</code>RGB显示模式（区分于颜色索引模式）、<code>GLUT_DEPTH</code>深度模式（三维）。</p></li>
<li><p>设置GLUT显示窗口大小，这里是500*500像素</p></li>
<li><p>设置GLUT初始显示位置（窗口左上角位置）：(x,y)=(100,100)</p></li>
<li><p>调用<code>glutCreateWindow</code>来创建窗口，传入参数为窗口的名字，但此时窗口并不会显示，直到调用<code>glutMainLoop</code>才会显示</p></li>
<li><p>调用<code>init</code>函数来做一些初始化工作</p></li>
</ul>


<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
</pre></td><td class='code'><pre><code class='cpp'><span class='line'><span class="kt">void</span> <span class="n">init</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="n">glClearColor</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">);</span> <span class="c1">// 用黑色清空屏幕</span>
</span><span class='line'>    <span class="n">glShadeModel</span><span class="p">(</span><span class="n">GL_FLAT</span><span class="p">);</span>  <span class="c1">// 设置着色模型，GL_FLAT为单调着色模式，默认为GL_SMOOTH平滑着色</span>
</span><span class='line'>    <span class="n">glEnable</span><span class="p">(</span><span class="n">GL_DEPTH_TEST</span><span class="p">);</span> <span class="c1">// 打开深度测试，即显示图像时有不同深度的物体的遮挡效果，默认为后显示的遮挡先显示的</span>
</span><span class='line'>
</span><span class='line'>    <span class="n">quadratic</span> <span class="o">=</span> <span class="n">gluNewQuadric</span><span class="p">();</span> <span class="c1">// 新建一个二次对象，用来画圆柱体</span>
</span><span class='line'>    <span class="n">gluQuadricNormals</span><span class="p">(</span><span class="n">quadratic</span><span class="p">,</span> <span class="n">GLU_SMOOTH</span><span class="p">);</span> <span class="c1">// 指定二次对象的法向量类型</span>
</span><span class='line'>    <span class="n">gluQuadricTexture</span><span class="p">(</span><span class="n">quadratic</span><span class="p">,</span> <span class="n">GL_TRUE</span><span class="p">);</span> <span class="c1">// 打开纹理显示</span>
</span><span class='line'>
</span><span class='line'>    <span class="n">lastClock</span> <span class="o">=</span> <span class="n">clock</span><span class="p">();</span> <span class="c1">// 记录当前的clock，用于计算FPS</span>
</span><span class='line'>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<ul>
<li><p>调用<code>glutDisplayFunc</code>设置显示响应函数<code>display</code>，这个稍后叙述。</p></li>
<li><p>调用<code>glutReshapeFunc</code>设置在窗口大小改变时的响应函数<code>reshape</code></p></li>
</ul>


<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
</pre></td><td class='code'><pre><code class='cpp'><span class='line'><span class="kt">void</span> <span class="n">reshape</span><span class="p">(</span><span class="kt">int</span> <span class="n">w</span><span class="p">,</span> <span class="kt">int</span> <span class="n">h</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="n">scrw</span> <span class="o">=</span> <span class="n">w</span><span class="p">;</span> <span class="c1">// 全局变量，记录当前的屏幕宽度</span>
</span><span class='line'>    <span class="n">scrh</span> <span class="o">=</span> <span class="n">h</span><span class="p">;</span> <span class="c1">// 全局变量，记录当前的屏幕高度</span>
</span><span class='line'>    <span class="n">glViewport</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="p">(</span><span class="n">GLsizei</span><span class="p">)</span> <span class="n">w</span><span class="p">,</span> <span class="p">(</span><span class="n">GLsizei</span><span class="p">)</span> <span class="n">h</span><span class="p">);</span> <span class="c1">// 设置显示区域大小</span>
</span><span class='line'>    <span class="n">glMatrixMode</span><span class="p">(</span><span class="n">GL_PROJECTION</span><span class="p">);</span> <span class="c1">// 把「投影矩阵」设置为当前矩阵</span>
</span><span class='line'>    <span class="n">glLoadIdentity</span><span class="p">();</span> <span class="c1">// 把矩阵设成单位矩阵</span>
</span><span class='line'>    <span class="n">gluPerspective</span><span class="p">(</span><span class="mf">60.0</span><span class="p">,</span> <span class="p">(</span><span class="n">GLfloat</span><span class="p">)</span> <span class="n">w</span> <span class="o">/</span> <span class="p">(</span><span class="n">GLfloat</span><span class="p">)</span> <span class="n">h</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1000.0</span><span class="p">);</span> <span class="c1">// 设置Perspective</span>
</span><span class='line'>    <span class="n">glMatrixMode</span><span class="p">(</span><span class="n">GL_MODELVIEW</span><span class="p">);</span> <span class="c1">// 把「模型视景矩阵」设置为当前矩阵</span>
</span><span class='line'>    <span class="n">glLoadIdentity</span><span class="p">();</span> <span class="c1">// 把矩阵设成单位矩阵</span>
</span><span class='line'>    <span class="n">gluLookAt</span><span class="p">(</span><span class="n">lookatx</span><span class="p">,</span> <span class="n">lookaty</span><span class="p">,</span> <span class="n">lookatz</span><span class="p">,</span> <span class="n">centerX</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">centerZ</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">);</span> <span class="c1">// 改变视角</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<ul>
<li>调用<code>glutKeyboardFunc</code>设置键盘按键响应函数<code>keyboard</code></li>
</ul>


<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
</pre></td><td class='code'><pre><code class='cpp'><span class='line'><span class="kt">void</span> <span class="n">keyboard</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">key</span><span class="p">,</span> <span class="kt">int</span> <span class="n">x</span><span class="p">,</span> <span class="kt">int</span> <span class="n">y</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="k">switch</span> <span class="p">(</span><span class="n">key</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>        <span class="c1">// 此处vangle为人的速度方向与x轴负方向的夹角</span>
</span><span class='line'>        <span class="k">case</span> <span class="sc">&#39;a&#39;</span><span class="o">:</span>
</span><span class='line'>            <span class="n">vangle</span> <span class="o">=</span> <span class="p">(</span><span class="n">vangle</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="mi">360</span><span class="p">;</span>
</span><span class='line'>            <span class="k">break</span><span class="p">;</span>
</span><span class='line'>        <span class="k">case</span> <span class="sc">&#39;d&#39;</span><span class="o">:</span>
</span><span class='line'>            <span class="n">vangle</span> <span class="o">=</span> <span class="p">(</span><span class="n">vangle</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="mi">360</span><span class="p">;</span>
</span><span class='line'>            <span class="k">break</span><span class="p">;</span>
</span><span class='line'>        <span class="k">case</span> <span class="mi">27</span><span class="o">:</span>
</span><span class='line'>            <span class="n">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span><span class='line'>        <span class="k">case</span> <span class="sc">&#39;s&#39;</span><span class="o">:</span>
</span><span class='line'>            <span class="n">vangle</span> <span class="o">=</span> <span class="p">(</span><span class="n">vangle</span> <span class="o">+</span> <span class="mi">180</span><span class="p">)</span> <span class="o">%</span> <span class="mi">360</span><span class="p">;</span>
</span><span class='line'>            <span class="k">break</span><span class="p">;</span>
</span><span class='line'>        <span class="k">default</span><span class="o">:</span>
</span><span class='line'>            <span class="k">break</span><span class="p">;</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<ul>
<li>调用<code>glutPassiveMotionFunc</code>设置鼠标在界面上移动时的响应函数<code>passiveMotionFunc</code></li>
</ul>


<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
</pre></td><td class='code'><pre><code class='cpp'><span class='line'><span class="kt">void</span> <span class="n">passiveMotionFunc</span><span class="p">(</span><span class="kt">int</span> <span class="n">x</span><span class="p">,</span> <span class="kt">int</span> <span class="n">y</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="c1">// 把视角限定在以人的胯部（坐标原点）为中心的半径为5.0的球面上</span>
</span><span class='line'>    <span class="n">lookatx</span> <span class="o">=</span> <span class="o">-</span><span class="mf">5.0</span> <span class="o">+</span> <span class="p">(</span><span class="kt">double</span><span class="p">)</span> <span class="n">x</span> <span class="o">/</span> <span class="n">scrw</span> <span class="o">*</span> <span class="mf">10.0</span><span class="p">;</span>
</span><span class='line'>    <span class="n">lookatz</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">(</span><span class="mi">25</span> <span class="o">-</span> <span class="n">lookatx</span> <span class="o">*</span> <span class="n">lookatx</span><span class="p">)</span> <span class="o">+</span> <span class="n">centerZ</span><span class="p">;</span>
</span><span class='line'>    <span class="n">lookatx</span> <span class="o">+=</span> <span class="n">centerX</span><span class="p">;</span>
</span><span class='line'>    <span class="kt">double</span> <span class="n">tmpy</span> <span class="o">=</span> <span class="o">-</span><span class="mf">5.0</span> <span class="o">+</span> <span class="p">(</span><span class="kt">double</span><span class="p">)</span> <span class="n">y</span> <span class="o">/</span> <span class="n">scrh</span> <span class="o">*</span> <span class="mf">10.0</span><span class="p">;</span>
</span><span class='line'>    <span class="c1">// 不可以低于地面</span>
</span><span class='line'>    <span class="k">if</span> <span class="p">(</span><span class="n">tmpy</span> <span class="o">&gt;=</span> <span class="o">-</span><span class="n">GLOBAL_SIZE</span> <span class="o">*</span> <span class="n">LEG_XSCALE</span> <span class="o">*</span> <span class="mi">2</span><span class="p">)</span>
</span><span class='line'>        <span class="n">lookaty</span> <span class="o">=</span> <span class="n">tmpy</span><span class="p">;</span>
</span><span class='line'>    <span class="n">glLoadIdentity</span><span class="p">();</span>
</span><span class='line'>
</span><span class='line'>    <span class="n">gluLookAt</span><span class="p">(</span><span class="n">lookatx</span><span class="p">,</span> <span class="n">lookaty</span><span class="p">,</span> <span class="n">lookatz</span><span class="p">,</span> <span class="n">centerX</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">centerZ</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">);</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<ul>
<li><p>调用<code>calculateData</code>计算数据并显示，稍后叙述</p></li>
<li><p>最后调用<code>glutMainLoop</code>进入OpenGL事件循环，窗口开始显示动画，开始接受鼠标、键盘输入事件</p></li>
</ul>


<h2>定义的全局变量</h2>

<p>其中的赋值为其初值</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class='cpp'><span class='line'><span class="k">static</span> <span class="kt">int</span> <span class="n">leftHigherLegAngle</span> <span class="o">=</span> <span class="o">-</span><span class="mi">60</span><span class="p">,</span> <span class="n">rightHigherLegAngle</span> <span class="o">=</span> <span class="o">-</span><span class="mi">120</span><span class="p">;</span> <span class="c1">// 大腿</span>
</span><span class='line'><span class="k">static</span> <span class="kt">int</span> <span class="n">leftLowerLegAngle</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">rightLowerLegAngle</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="c1">// 小腿</span>
</span><span class='line'><span class="k">static</span> <span class="kt">int</span> <span class="n">leftHigherHandAngle</span> <span class="o">=</span> <span class="o">-</span><span class="mi">120</span><span class="p">,</span> <span class="n">rightHigherHandAngle</span> <span class="o">=</span> <span class="o">-</span><span class="mi">60</span><span class="p">;</span> <span class="c1">// 手臂上半部</span>
</span><span class='line'><span class="k">static</span> <span class="kt">int</span> <span class="n">leftLowerHandAngle</span> <span class="o">=</span> <span class="o">-</span><span class="mi">60</span><span class="p">,</span> <span class="n">rightLowerHandAngle</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="c1">// 手臂下半部</span>
</span><span class='line'><span class="k">static</span> <span class="kt">int</span> <span class="n">leftFootAngle</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">rightFootAngle</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="c1">// 脚掌</span>
</span><span class='line'>
</span><span class='line'><span class="k">static</span> <span class="n">GLfloat</span> <span class="n">centerX</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span> <span class="n">centerY</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span> <span class="n">centerZ</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">;</span> <span class="c1">// 胯部坐标（人的中心）</span>
</span><span class='line'><span class="k">static</span> <span class="n">GLint</span> <span class="n">vangle</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="c1">// 人的前进速度方向与x轴负方向的夹角</span>
</span><span class='line'>
</span><span class='line'><span class="k">static</span> <span class="n">clock_t</span> <span class="n">lastClock</span><span class="p">;</span> <span class="c1">// 记录的clock，用于计算FPS</span>
</span></code></pre></td></tr></table></div></figure>


<h2>calculateData函数，计算关节角度</h2>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
<span class='line-number'>60</span>
<span class='line-number'>61</span>
<span class='line-number'>62</span>
<span class='line-number'>63</span>
<span class='line-number'>64</span>
<span class='line-number'>65</span>
<span class='line-number'>66</span>
<span class='line-number'>67</span>
</pre></td><td class='code'><pre><code class='cpp'><span class='line'><span class="kt">void</span> <span class="n">calculateData</span><span class="p">(</span><span class="kt">int</span> <span class="n">id</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="c1">// 使人的胯部离地面的距离随着动作的改变而改变</span>
</span><span class='line'>    <span class="n">centerY</span> <span class="o">=</span> <span class="n">legLength</span> <span class="o">*</span> <span class="n">sin</span><span class="p">(</span><span class="o">-</span><span class="n">leftHigherLegAngle</span> <span class="o">/</span> <span class="mf">180.0</span> <span class="o">*</span> <span class="n">PI</span><span class="p">)</span> <span class="o">-</span> <span class="n">legLength</span><span class="p">;</span>
</span><span class='line'>    <span class="c1">// 为了简化计算，我粗略假定大腿每动1度，人会朝着其方向前进0.035个单位长度</span>
</span><span class='line'>    <span class="kt">double</span> <span class="n">mvx</span> <span class="o">=</span> <span class="n">cos</span><span class="p">(</span><span class="n">vangle</span> <span class="o">/</span> <span class="mf">180.0</span> <span class="o">*</span> <span class="n">PI</span><span class="p">)</span> <span class="o">*</span> <span class="mf">0.035</span><span class="p">;</span> <span class="c1">// 计算x轴方向移动的距离</span>
</span><span class='line'>    <span class="kt">double</span> <span class="n">mvz</span> <span class="o">=</span> <span class="n">sin</span><span class="p">(</span><span class="n">vangle</span> <span class="o">/</span> <span class="mf">180.0</span> <span class="o">*</span> <span class="n">PI</span><span class="p">)</span> <span class="o">*</span> <span class="mf">0.035</span><span class="p">;</span> <span class="c1">// 计算z轴方向移动的距离</span>
</span><span class='line'>
</span><span class='line'>    <span class="c1">// dir1为全局变量，为true时右脚向前，为false时左脚向前</span>
</span><span class='line'>    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">dir1</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>        <span class="n">leftHigherLegAngle</span> <span class="o">--</span><span class="p">;</span>  <span class="c1">// 左脚向前运动</span>
</span><span class='line'>        <span class="n">rightHigherLegAngle</span> <span class="o">++</span><span class="p">;</span> <span class="c1">// 右脚向后运动</span>
</span><span class='line'>        <span class="k">if</span> <span class="p">(</span><span class="n">leftHigherLegAngle</span> <span class="o">&gt;=</span> <span class="o">-</span><span class="mi">75</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>            <span class="c1">// 若左腿的角度已经大于-75，那么左脚小腿向上翘起</span>
</span><span class='line'>            <span class="n">leftLowerLegAngle</span> <span class="o">+=</span> <span class="mi">6</span><span class="p">;</span>
</span><span class='line'>            <span class="n">leftFootAngle</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span><span class='line'>        <span class="p">}</span>
</span><span class='line'>        <span class="c1">// 若左脚角度小于-105，那么左腿小腿向前踢</span>
</span><span class='line'>        <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">leftHigherLegAngle</span> <span class="o">&lt;</span> <span class="o">-</span><span class="mi">105</span><span class="p">)</span> <span class="n">leftLowerLegAngle</span> <span class="o">-=</span> <span class="mi">6</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>        <span class="c1">// 若已经达到-120度（大腿的运动范围为[-120, -60]）</span>
</span><span class='line'>        <span class="k">if</span> <span class="p">(</span><span class="n">leftHigherLegAngle</span> <span class="o">==</span> <span class="o">-</span><span class="mi">120</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>            <span class="n">dir1</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
</span><span class='line'>        <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>        <span class="c1">// 此时右脚着地，计算右脚脚掌的角度，始终贴着地面</span>
</span><span class='line'>        <span class="n">rightFootAngle</span> <span class="o">=</span> <span class="o">-</span><span class="n">rightHigherLegAngle</span> <span class="o">-</span> <span class="mi">90</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>        <span class="c1">// 手部简单地匀速运动，运动范围为60度</span>
</span><span class='line'>        <span class="n">leftHigherHandAngle</span> <span class="o">++</span><span class="p">;</span>
</span><span class='line'>        <span class="n">leftLowerHandAngle</span> <span class="o">++</span><span class="p">;</span>
</span><span class='line'>        <span class="n">rightHigherHandAngle</span> <span class="o">--</span><span class="p">;</span>
</span><span class='line'>        <span class="n">rightLowerHandAngle</span> <span class="o">--</span><span class="p">;</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>    <span class="k">else</span> <span class="p">{</span>
</span><span class='line'>        <span class="n">leftHigherLegAngle</span> <span class="o">++</span><span class="p">;</span>
</span><span class='line'>        <span class="n">rightHigherLegAngle</span> <span class="o">--</span><span class="p">;</span>
</span><span class='line'>        <span class="k">if</span> <span class="p">(</span><span class="n">rightHigherLegAngle</span> <span class="o">&gt;=</span> <span class="o">-</span><span class="mi">75</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>            <span class="n">rightLowerLegAngle</span> <span class="o">+=</span> <span class="mi">6</span><span class="p">;</span>
</span><span class='line'>            <span class="n">rightFootAngle</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span><span class='line'>        <span class="p">}</span>
</span><span class='line'>        <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">rightHigherLegAngle</span> <span class="o">&lt;</span> <span class="o">-</span><span class="mi">105</span><span class="p">)</span> <span class="n">rightLowerLegAngle</span> <span class="o">-=</span> <span class="mi">6</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>        <span class="k">if</span> <span class="p">(</span><span class="n">leftHigherLegAngle</span> <span class="o">==</span> <span class="o">-</span><span class="mi">60</span><span class="p">)</span> <span class="n">dir1</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>        <span class="n">leftFootAngle</span> <span class="o">=</span> <span class="o">-</span><span class="n">leftHigherLegAngle</span> <span class="o">-</span> <span class="mi">90</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>        <span class="n">leftHigherHandAngle</span> <span class="o">--</span><span class="p">;</span>
</span><span class='line'>        <span class="n">leftLowerHandAngle</span> <span class="o">--</span><span class="p">;</span>
</span><span class='line'>        <span class="n">rightHigherHandAngle</span> <span class="o">++</span><span class="p">;</span>
</span><span class='line'>        <span class="n">rightLowerHandAngle</span> <span class="o">++</span><span class="p">;</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>    <span class="c1">// 人移动</span>
</span><span class='line'>    <span class="n">centerX</span> <span class="o">-=</span> <span class="n">mvx</span><span class="p">;</span>
</span><span class='line'>    <span class="n">lookatx</span> <span class="o">-=</span> <span class="n">mvx</span><span class="p">;</span>
</span><span class='line'>    <span class="n">centerZ</span> <span class="o">+=</span> <span class="n">mvz</span><span class="p">;</span>
</span><span class='line'>    <span class="n">lookatz</span> <span class="o">+=</span> <span class="n">mvz</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>    <span class="c1">// 调整视角，始终把屏幕中心对准人的中心</span>
</span><span class='line'>    <span class="n">glLoadIdentity</span><span class="p">();</span>
</span><span class='line'>    <span class="n">gluLookAt</span><span class="p">(</span><span class="n">lookatx</span><span class="p">,</span> <span class="n">lookaty</span><span class="p">,</span> <span class="n">lookatz</span><span class="p">,</span> <span class="n">centerX</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">centerZ</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'>    <span class="c1">// 刷新屏幕</span>
</span><span class='line'>    <span class="n">glutPostRedisplay</span><span class="p">();</span>
</span><span class='line'>    <span class="c1">// 设置定时器函数，1毫秒后再重新调用calculateData</span>
</span><span class='line'>    <span class="n">glutTimerFunc</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">calculateData</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<h2>宏定义的常量</h2>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
</pre></td><td class='code'><pre><code class='cpp'><span class='line'><span class="cp">#define GLOBAL_SIZE 0.5              </span><span class="c1">// 全局缩放比例</span>
</span><span class='line'><span class="cp">// 绘制脚部长方体所需的坐标系缩放比例</span>
</span><span class='line'><span class="cp">#define LEG_XSCALE 2.0</span>
</span><span class='line'><span class="cp">#define LEG_YSCALE 0.4</span>
</span><span class='line'><span class="cp">#define LEG_ZSCALE 0.4</span>
</span><span class='line'><span class="cp">// 身体的长方体</span>
</span><span class='line'><span class="cp">#define BODY_XSCALE 0.5</span>
</span><span class='line'><span class="cp">#define BODY_YSCALE LEG_XSCALE * 1.2</span>
</span><span class='line'><span class="cp">#define BODY_ZSCALE 1.5</span>
</span><span class='line'><span class="cp">// 头部的半径为身体的厚度</span>
</span><span class='line'><span class="cp">#define HEAD_RADIUS GLOBAL_SIZE * BODY_XSCALE</span>
</span><span class='line'><span class="cp">// 手臂的长方体</span>
</span><span class='line'><span class="cp">#define HAND_XSCALE 1.6</span>
</span><span class='line'><span class="cp">#define HAND_YSCALE LEG_YSCALE</span>
</span><span class='line'><span class="cp">#define HAND_ZSCALE LEG_ZSCALE</span>
</span><span class='line'><span class="cp">// 脚掌的长方体</span>
</span><span class='line'><span class="cp">#define FOOT_XSCALE 1.0</span>
</span><span class='line'><span class="cp">#define FOOT_YSCALE 0.3</span>
</span><span class='line'><span class="cp">#define FOOT_ZSCALE LEG_ZSCALE</span>
</span></code></pre></td></tr></table></div></figure>


<h2>display函数，画出虚拟人模型</h2>

<p>这个函数是根据<code>calculateData</code>函数计算出的值来重画整个屏幕。Talk is less.
这里面的<code>glPushMatrix</code>函数可能用得不好，有些冗余，原因是我在做这个作业的时候代码是一点点增加的，先是只有一只脚，然后两只脚，然后加个身……</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
<span class='line-number'>60</span>
<span class='line-number'>61</span>
<span class='line-number'>62</span>
<span class='line-number'>63</span>
<span class='line-number'>64</span>
<span class='line-number'>65</span>
<span class='line-number'>66</span>
<span class='line-number'>67</span>
<span class='line-number'>68</span>
<span class='line-number'>69</span>
<span class='line-number'>70</span>
<span class='line-number'>71</span>
<span class='line-number'>72</span>
<span class='line-number'>73</span>
<span class='line-number'>74</span>
<span class='line-number'>75</span>
<span class='line-number'>76</span>
<span class='line-number'>77</span>
<span class='line-number'>78</span>
<span class='line-number'>79</span>
<span class='line-number'>80</span>
<span class='line-number'>81</span>
<span class='line-number'>82</span>
<span class='line-number'>83</span>
<span class='line-number'>84</span>
<span class='line-number'>85</span>
<span class='line-number'>86</span>
<span class='line-number'>87</span>
<span class='line-number'>88</span>
<span class='line-number'>89</span>
<span class='line-number'>90</span>
<span class='line-number'>91</span>
<span class='line-number'>92</span>
<span class='line-number'>93</span>
<span class='line-number'>94</span>
<span class='line-number'>95</span>
<span class='line-number'>96</span>
<span class='line-number'>97</span>
<span class='line-number'>98</span>
<span class='line-number'>99</span>
<span class='line-number'>100</span>
<span class='line-number'>101</span>
<span class='line-number'>102</span>
<span class='line-number'>103</span>
<span class='line-number'>104</span>
<span class='line-number'>105</span>
<span class='line-number'>106</span>
<span class='line-number'>107</span>
<span class='line-number'>108</span>
<span class='line-number'>109</span>
<span class='line-number'>110</span>
<span class='line-number'>111</span>
<span class='line-number'>112</span>
<span class='line-number'>113</span>
<span class='line-number'>114</span>
<span class='line-number'>115</span>
<span class='line-number'>116</span>
<span class='line-number'>117</span>
<span class='line-number'>118</span>
<span class='line-number'>119</span>
<span class='line-number'>120</span>
<span class='line-number'>121</span>
<span class='line-number'>122</span>
<span class='line-number'>123</span>
<span class='line-number'>124</span>
<span class='line-number'>125</span>
<span class='line-number'>126</span>
<span class='line-number'>127</span>
<span class='line-number'>128</span>
<span class='line-number'>129</span>
<span class='line-number'>130</span>
<span class='line-number'>131</span>
<span class='line-number'>132</span>
<span class='line-number'>133</span>
<span class='line-number'>134</span>
<span class='line-number'>135</span>
<span class='line-number'>136</span>
<span class='line-number'>137</span>
<span class='line-number'>138</span>
<span class='line-number'>139</span>
<span class='line-number'>140</span>
<span class='line-number'>141</span>
<span class='line-number'>142</span>
<span class='line-number'>143</span>
<span class='line-number'>144</span>
<span class='line-number'>145</span>
<span class='line-number'>146</span>
<span class='line-number'>147</span>
<span class='line-number'>148</span>
<span class='line-number'>149</span>
<span class='line-number'>150</span>
<span class='line-number'>151</span>
<span class='line-number'>152</span>
<span class='line-number'>153</span>
<span class='line-number'>154</span>
<span class='line-number'>155</span>
<span class='line-number'>156</span>
<span class='line-number'>157</span>
<span class='line-number'>158</span>
<span class='line-number'>159</span>
<span class='line-number'>160</span>
<span class='line-number'>161</span>
<span class='line-number'>162</span>
<span class='line-number'>163</span>
<span class='line-number'>164</span>
<span class='line-number'>165</span>
<span class='line-number'>166</span>
<span class='line-number'>167</span>
<span class='line-number'>168</span>
<span class='line-number'>169</span>
<span class='line-number'>170</span>
<span class='line-number'>171</span>
<span class='line-number'>172</span>
<span class='line-number'>173</span>
<span class='line-number'>174</span>
<span class='line-number'>175</span>
<span class='line-number'>176</span>
<span class='line-number'>177</span>
<span class='line-number'>178</span>
<span class='line-number'>179</span>
<span class='line-number'>180</span>
<span class='line-number'>181</span>
<span class='line-number'>182</span>
</pre></td><td class='code'><pre><code class='cpp'><span class='line'><span class="kt">void</span> <span class="n">display</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="n">calFPS</span><span class="p">();</span> <span class="c1">// 计算FPS</span>
</span><span class='line'>
</span><span class='line'>    <span class="n">glClear</span><span class="p">(</span><span class="n">GL_COLOR_BUFFER_BIT</span> <span class="o">|</span> <span class="n">GL_DEPTH_BUFFER_BIT</span><span class="p">);</span> <span class="c1">// 清空颜色缓冲和深度缓冲</span>
</span><span class='line'>
</span><span class='line'>    <span class="n">glColor3f</span><span class="p">(</span><span class="mf">0.8</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">);</span> <span class="c1">// 设置颜色为深灰色</span>
</span><span class='line'>    <span class="c1">// 画地面，以当前人的位置，前后纵横各画30条线段，整个平面为正方形</span>
</span><span class='line'>    <span class="kt">int</span> <span class="n">minx</span> <span class="o">=</span> <span class="p">(</span><span class="kt">int</span><span class="p">)</span> <span class="n">centerX</span> <span class="o">-</span> <span class="mi">30</span><span class="p">;</span>
</span><span class='line'>    <span class="kt">int</span> <span class="n">maxx</span> <span class="o">=</span> <span class="p">(</span><span class="kt">int</span><span class="p">)</span> <span class="n">centerX</span> <span class="o">+</span> <span class="mi">30</span><span class="p">;</span>
</span><span class='line'>    <span class="kt">int</span> <span class="n">minz</span> <span class="o">=</span> <span class="p">(</span><span class="kt">int</span><span class="p">)</span> <span class="n">centerZ</span> <span class="o">-</span> <span class="mi">30</span><span class="p">;</span>
</span><span class='line'>    <span class="kt">int</span> <span class="n">maxz</span> <span class="o">=</span> <span class="p">(</span><span class="kt">int</span><span class="p">)</span> <span class="n">centerZ</span> <span class="o">+</span> <span class="mi">30</span><span class="p">;</span>
</span><span class='line'>    <span class="c1">// 画竖线</span>
</span><span class='line'>    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">x</span> <span class="o">=</span> <span class="n">minx</span><span class="p">;</span> <span class="n">x</span> <span class="o">&lt;=</span> <span class="n">maxx</span><span class="p">;</span> <span class="o">++</span> <span class="n">x</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>        <span class="n">glBegin</span><span class="p">(</span><span class="n">GL_LINES</span><span class="p">);</span>
</span><span class='line'>            <span class="n">glVertex3f</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="o">-</span><span class="n">GLOBAL_SIZE</span> <span class="o">*</span> <span class="n">LEG_XSCALE</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">-</span> <span class="n">GLOBAL_SIZE</span> <span class="o">*</span> <span class="n">FOOT_YSCALE</span><span class="p">,</span> <span class="n">minz</span><span class="p">);</span>
</span><span class='line'>            <span class="n">glVertex3f</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="o">-</span><span class="n">GLOBAL_SIZE</span> <span class="o">*</span> <span class="n">LEG_XSCALE</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">-</span> <span class="n">GLOBAL_SIZE</span> <span class="o">*</span> <span class="n">FOOT_YSCALE</span><span class="p">,</span> <span class="n">maxz</span><span class="p">);</span>
</span><span class='line'>        <span class="n">glEnd</span><span class="p">();</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>    <span class="c1">// 画横线</span>
</span><span class='line'>    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">z</span> <span class="o">=</span> <span class="n">minz</span><span class="p">;</span> <span class="n">z</span> <span class="o">&lt;=</span> <span class="n">maxz</span><span class="p">;</span> <span class="o">++</span> <span class="n">z</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>        <span class="n">glBegin</span><span class="p">(</span><span class="n">GL_LINES</span><span class="p">);</span>
</span><span class='line'>            <span class="n">glVertex3f</span><span class="p">(</span><span class="n">minx</span><span class="p">,</span> <span class="o">-</span><span class="n">GLOBAL_SIZE</span> <span class="o">*</span> <span class="n">LEG_XSCALE</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">-</span> <span class="n">GLOBAL_SIZE</span> <span class="o">*</span> <span class="n">FOOT_YSCALE</span><span class="p">,</span> <span class="n">z</span><span class="p">);</span>
</span><span class='line'>            <span class="n">glVertex3f</span><span class="p">(</span><span class="n">maxx</span><span class="p">,</span> <span class="o">-</span><span class="n">GLOBAL_SIZE</span> <span class="o">*</span> <span class="n">LEG_XSCALE</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">-</span> <span class="n">GLOBAL_SIZE</span> <span class="o">*</span> <span class="n">FOOT_YSCALE</span><span class="p">,</span> <span class="n">z</span><span class="p">);</span>
</span><span class='line'>        <span class="n">glEnd</span><span class="p">();</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>    <span class="n">glPushMatrix</span><span class="p">();</span>
</span><span class='line'>        <span class="n">glTranslatef</span><span class="p">(</span><span class="n">centerX</span><span class="p">,</span> <span class="n">centerY</span><span class="p">,</span> <span class="n">centerZ</span><span class="p">);</span> <span class="c1">// 把坐标系原点移到当前人的中心所在位置</span>
</span><span class='line'>        <span class="n">glRotatef</span><span class="p">(</span><span class="n">vangle</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">);</span> <span class="c1">// 旋转vangle角度，使人对着其前进方向</span>
</span><span class='line'>
</span><span class='line'>        <span class="n">glColor3f</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">);</span> <span class="c1">// 设置颜色为灰色</span>
</span><span class='line'>        <span class="c1">// 画左脚</span>
</span><span class='line'>        <span class="n">glPushMatrix</span><span class="p">();</span>
</span><span class='line'>            <span class="n">glRotatef</span><span class="p">((</span><span class="n">GLfloat</span><span class="p">)</span> <span class="n">leftHigherLegAngle</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">);</span>
</span><span class='line'>            <span class="n">glTranslatef</span><span class="p">(</span><span class="n">GLOBAL_SIZE</span> <span class="o">*</span> <span class="n">LEG_XSCALE</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="n">GLOBAL_SIZE</span> <span class="o">*</span> <span class="n">LEG_ZSCALE</span><span class="p">);</span>
</span><span class='line'>            <span class="n">glPushMatrix</span><span class="p">();</span>
</span><span class='line'>                <span class="n">glScalef</span><span class="p">(</span><span class="n">LEG_XSCALE</span><span class="p">,</span> <span class="n">LEG_YSCALE</span><span class="p">,</span> <span class="n">LEG_ZSCALE</span><span class="p">);</span>
</span><span class='line'>                <span class="n">glutSolidCube</span><span class="p">(</span><span class="n">GLOBAL_SIZE</span><span class="p">);</span>
</span><span class='line'>            <span class="n">glPopMatrix</span><span class="p">();</span>
</span><span class='line'>            <span class="n">glTranslatef</span><span class="p">(</span><span class="n">GLOBAL_SIZE</span> <span class="o">*</span> <span class="n">LEG_XSCALE</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">);</span>
</span><span class='line'>            <span class="c1">// 画关节</span>
</span><span class='line'>            <span class="n">glPushMatrix</span><span class="p">();</span>
</span><span class='line'>                <span class="n">glTranslatef</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="o">-</span><span class="n">GLOBAL_SIZE</span> <span class="o">*</span> <span class="n">LEG_ZSCALE</span> <span class="o">/</span> <span class="mi">2</span><span class="p">);</span>
</span><span class='line'>                <span class="n">gluCylinder</span><span class="p">(</span><span class="n">quadratic</span><span class="p">,</span> <span class="n">GLOBAL_SIZE</span> <span class="o">*</span> <span class="n">LEG_YSCALE</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span>
</span><span class='line'>                      <span class="n">GLOBAL_SIZE</span> <span class="o">*</span> <span class="n">LEG_YSCALE</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">GLOBAL_SIZE</span> <span class="o">*</span> <span class="n">LEG_ZSCALE</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">32</span><span class="p">);</span>
</span><span class='line'>                <span class="n">glTranslatef</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="n">GLOBAL_SIZE</span> <span class="o">*</span> <span class="n">LEG_ZSCALE</span><span class="p">);</span>
</span><span class='line'>                <span class="n">drawSolidCircle</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="n">GLOBAL_SIZE</span> <span class="o">*</span> <span class="n">LEG_YSCALE</span> <span class="o">/</span> <span class="mi">2</span><span class="p">);</span>
</span><span class='line'>                <span class="n">glTranslatef</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="o">-</span><span class="n">GLOBAL_SIZE</span> <span class="o">*</span> <span class="n">LEG_ZSCALE</span><span class="p">);</span>
</span><span class='line'>                <span class="n">drawSolidCircle</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="n">GLOBAL_SIZE</span> <span class="o">*</span> <span class="n">LEG_YSCALE</span> <span class="o">/</span> <span class="mi">2</span><span class="p">);</span>
</span><span class='line'>            <span class="n">glPopMatrix</span><span class="p">();</span>
</span><span class='line'>            <span class="n">glRotatef</span><span class="p">((</span><span class="n">GLfloat</span><span class="p">)</span> <span class="n">leftLowerLegAngle</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">);</span>
</span><span class='line'>            <span class="n">glTranslatef</span><span class="p">(</span><span class="n">GLOBAL_SIZE</span> <span class="o">*</span> <span class="n">LEG_XSCALE</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">);</span>
</span><span class='line'>            <span class="n">glPushMatrix</span><span class="p">();</span>
</span><span class='line'>                <span class="n">glScalef</span><span class="p">(</span><span class="n">LEG_XSCALE</span><span class="p">,</span> <span class="n">LEG_YSCALE</span><span class="p">,</span> <span class="n">LEG_ZSCALE</span><span class="p">);</span>
</span><span class='line'>                <span class="n">glutSolidCube</span><span class="p">(</span><span class="n">GLOBAL_SIZE</span><span class="p">);</span>
</span><span class='line'>            <span class="n">glPopMatrix</span><span class="p">();</span>
</span><span class='line'>            <span class="c1">// 画脚掌</span>
</span><span class='line'>            <span class="n">glTranslatef</span><span class="p">(</span><span class="n">GLOBAL_SIZE</span> <span class="o">*</span> <span class="n">LEG_XSCALE</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">);</span>
</span><span class='line'>            <span class="n">glRotatef</span><span class="p">(</span><span class="mf">90.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">);</span>
</span><span class='line'>            <span class="n">glTranslatef</span><span class="p">(</span><span class="o">-</span><span class="n">GLOBAL_SIZE</span> <span class="o">*</span> <span class="n">FOOT_XSCALE</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">GLOBAL_SIZE</span> <span class="o">*</span> <span class="n">LEG_YSCALE</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">);</span>
</span><span class='line'>            <span class="n">glRotatef</span><span class="p">((</span><span class="n">GLfloat</span><span class="p">)</span> <span class="n">leftFootAngle</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">);</span>
</span><span class='line'>            <span class="n">glPushMatrix</span><span class="p">();</span>
</span><span class='line'>                <span class="n">glScalef</span><span class="p">(</span><span class="n">FOOT_XSCALE</span><span class="p">,</span> <span class="n">FOOT_YSCALE</span><span class="p">,</span> <span class="n">FOOT_ZSCALE</span><span class="p">);</span>
</span><span class='line'>                <span class="n">glutSolidCube</span><span class="p">(</span><span class="n">GLOBAL_SIZE</span><span class="p">);</span>
</span><span class='line'>            <span class="n">glPopMatrix</span><span class="p">();</span>
</span><span class='line'>        <span class="n">glPopMatrix</span><span class="p">();</span>
</span><span class='line'>
</span><span class='line'>        <span class="c1">// 同理画右脚</span>
</span><span class='line'>        <span class="n">glPushMatrix</span><span class="p">();</span>
</span><span class='line'>            <span class="n">glRotatef</span><span class="p">((</span><span class="n">GLfloat</span><span class="p">)</span> <span class="n">rightHigherLegAngle</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">);</span>
</span><span class='line'>            <span class="n">glTranslatef</span><span class="p">(</span><span class="n">GLOBAL_SIZE</span> <span class="o">*</span> <span class="n">LEG_XSCALE</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="o">-</span><span class="n">GLOBAL_SIZE</span> <span class="o">*</span> <span class="n">LEG_ZSCALE</span><span class="p">);</span>
</span><span class='line'>            <span class="n">glPushMatrix</span><span class="p">();</span>
</span><span class='line'>                <span class="n">glScalef</span><span class="p">(</span><span class="n">LEG_XSCALE</span><span class="p">,</span> <span class="n">LEG_YSCALE</span><span class="p">,</span> <span class="n">LEG_ZSCALE</span><span class="p">);</span>
</span><span class='line'>                <span class="n">glutSolidCube</span><span class="p">(</span><span class="n">GLOBAL_SIZE</span><span class="p">);</span>
</span><span class='line'>            <span class="n">glPopMatrix</span><span class="p">();</span>
</span><span class='line'>            <span class="n">glTranslatef</span><span class="p">(</span><span class="n">GLOBAL_SIZE</span> <span class="o">*</span> <span class="n">LEG_XSCALE</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">);</span>
</span><span class='line'>            <span class="c1">// 关节</span>
</span><span class='line'>            <span class="n">glPushMatrix</span><span class="p">();</span>
</span><span class='line'>                <span class="n">glTranslatef</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="o">-</span><span class="n">GLOBAL_SIZE</span> <span class="o">*</span> <span class="n">LEG_ZSCALE</span> <span class="o">/</span> <span class="mi">2</span><span class="p">);</span>
</span><span class='line'>                <span class="n">gluCylinder</span><span class="p">(</span><span class="n">quadratic</span><span class="p">,</span> <span class="n">GLOBAL_SIZE</span> <span class="o">*</span> <span class="n">LEG_YSCALE</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span>
</span><span class='line'>                      <span class="n">GLOBAL_SIZE</span> <span class="o">*</span> <span class="n">LEG_YSCALE</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">GLOBAL_SIZE</span> <span class="o">*</span> <span class="n">LEG_ZSCALE</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">32</span><span class="p">);</span>
</span><span class='line'>                <span class="n">glTranslatef</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="n">GLOBAL_SIZE</span> <span class="o">*</span> <span class="n">LEG_ZSCALE</span><span class="p">);</span>
</span><span class='line'>                <span class="n">drawSolidCircle</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="n">GLOBAL_SIZE</span> <span class="o">*</span> <span class="n">LEG_YSCALE</span> <span class="o">/</span> <span class="mi">2</span><span class="p">);</span>
</span><span class='line'>                <span class="n">glTranslatef</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="o">-</span><span class="n">GLOBAL_SIZE</span> <span class="o">*</span> <span class="n">LEG_ZSCALE</span><span class="p">);</span>
</span><span class='line'>                <span class="n">drawSolidCircle</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="n">GLOBAL_SIZE</span> <span class="o">*</span> <span class="n">LEG_YSCALE</span> <span class="o">/</span> <span class="mi">2</span><span class="p">);</span>
</span><span class='line'>            <span class="n">glPopMatrix</span><span class="p">();</span>
</span><span class='line'>            <span class="n">glRotatef</span><span class="p">((</span><span class="n">GLfloat</span><span class="p">)</span> <span class="n">rightLowerLegAngle</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">);</span>
</span><span class='line'>            <span class="n">glTranslatef</span><span class="p">(</span><span class="n">GLOBAL_SIZE</span> <span class="o">*</span> <span class="n">LEG_XSCALE</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">);</span>
</span><span class='line'>            <span class="n">glPushMatrix</span><span class="p">();</span>
</span><span class='line'>                <span class="n">glScalef</span><span class="p">(</span><span class="n">LEG_XSCALE</span><span class="p">,</span> <span class="n">LEG_YSCALE</span><span class="p">,</span> <span class="n">LEG_ZSCALE</span><span class="p">);</span>
</span><span class='line'>                <span class="n">glutSolidCube</span><span class="p">(</span><span class="n">GLOBAL_SIZE</span><span class="p">);</span>
</span><span class='line'>            <span class="n">glPopMatrix</span><span class="p">();</span>
</span><span class='line'>            <span class="c1">// 脚掌</span>
</span><span class='line'>            <span class="n">glTranslatef</span><span class="p">(</span><span class="n">GLOBAL_SIZE</span> <span class="o">*</span> <span class="n">LEG_XSCALE</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">);</span>
</span><span class='line'>            <span class="n">glRotatef</span><span class="p">(</span><span class="mf">90.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">);</span>
</span><span class='line'>            <span class="n">glTranslatef</span><span class="p">(</span><span class="o">-</span><span class="n">GLOBAL_SIZE</span> <span class="o">*</span> <span class="n">FOOT_XSCALE</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">GLOBAL_SIZE</span> <span class="o">*</span> <span class="n">LEG_YSCALE</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">);</span>
</span><span class='line'>            <span class="n">glRotatef</span><span class="p">((</span><span class="n">GLfloat</span><span class="p">)</span> <span class="n">rightFootAngle</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">);</span>
</span><span class='line'>            <span class="n">glPushMatrix</span><span class="p">();</span>
</span><span class='line'>                <span class="n">glScalef</span><span class="p">(</span><span class="n">FOOT_XSCALE</span><span class="p">,</span> <span class="n">FOOT_YSCALE</span><span class="p">,</span> <span class="n">FOOT_ZSCALE</span><span class="p">);</span>
</span><span class='line'>                <span class="n">glutSolidCube</span><span class="p">(</span><span class="n">GLOBAL_SIZE</span><span class="p">);</span>
</span><span class='line'>            <span class="n">glPopMatrix</span><span class="p">();</span>
</span><span class='line'>        <span class="n">glPopMatrix</span><span class="p">();</span>
</span><span class='line'>
</span><span class='line'>        <span class="c1">// 身体</span>
</span><span class='line'>        <span class="n">glColor3f</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">);</span> <span class="c1">// 头和身颜色为白色</span>
</span><span class='line'>        <span class="n">glPushMatrix</span><span class="p">();</span>
</span><span class='line'>            <span class="n">glTranslatef</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">GLOBAL_SIZE</span> <span class="o">*</span> <span class="n">BODY_YSCALE</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">);</span>
</span><span class='line'>            <span class="n">glScalef</span><span class="p">(</span><span class="n">BODY_XSCALE</span><span class="p">,</span> <span class="n">BODY_YSCALE</span><span class="p">,</span> <span class="n">BODY_ZSCALE</span><span class="p">);</span>
</span><span class='line'>            <span class="n">glutSolidCube</span><span class="p">(</span><span class="n">GLOBAL_SIZE</span><span class="p">);</span>
</span><span class='line'>        <span class="n">glPopMatrix</span><span class="p">();</span>
</span><span class='line'>
</span><span class='line'>        <span class="c1">// 头部</span>
</span><span class='line'>        <span class="n">glPushMatrix</span><span class="p">();</span>
</span><span class='line'>            <span class="n">glTranslatef</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">GLOBAL_SIZE</span> <span class="o">*</span> <span class="n">BODY_YSCALE</span> <span class="o">+</span> <span class="n">HEAD_RADIUS</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">);</span>
</span><span class='line'>            <span class="n">glutSolidSphere</span><span class="p">(</span><span class="n">HEAD_RADIUS</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">8</span><span class="p">);</span>
</span><span class='line'>        <span class="n">glPopMatrix</span><span class="p">();</span>
</span><span class='line'>
</span><span class='line'>        <span class="c1">// 左手</span>
</span><span class='line'>        <span class="n">glColor3f</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">);</span> <span class="c1">// 颜色为灰色</span>
</span><span class='line'>        <span class="n">glPushMatrix</span><span class="p">();</span>
</span><span class='line'>            <span class="n">glTranslatef</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">GLOBAL_SIZE</span> <span class="o">*</span> <span class="n">BODY_YSCALE</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">);</span>
</span><span class='line'>            <span class="n">glRotatef</span><span class="p">((</span><span class="n">GLfloat</span><span class="p">)</span> <span class="n">leftHigherHandAngle</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">);</span>
</span><span class='line'>            <span class="n">glTranslatef</span><span class="p">(</span><span class="n">GLOBAL_SIZE</span> <span class="o">*</span> <span class="n">HAND_XSCALE</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span>
</span><span class='line'>                  <span class="n">GLOBAL_SIZE</span> <span class="o">*</span> <span class="p">(</span><span class="n">BODY_ZSCALE</span> <span class="o">+</span> <span class="n">HAND_ZSCALE</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">);</span>
</span><span class='line'>            <span class="n">glPushMatrix</span><span class="p">();</span>
</span><span class='line'>                <span class="n">glScalef</span><span class="p">(</span><span class="n">HAND_XSCALE</span><span class="p">,</span> <span class="n">HAND_YSCALE</span><span class="p">,</span> <span class="n">HAND_ZSCALE</span><span class="p">);</span>
</span><span class='line'>                <span class="n">glutSolidCube</span><span class="p">(</span><span class="n">GLOBAL_SIZE</span><span class="p">);</span>
</span><span class='line'>            <span class="n">glPopMatrix</span><span class="p">();</span>
</span><span class='line'>            <span class="n">glTranslatef</span><span class="p">(</span><span class="n">GLOBAL_SIZE</span> <span class="o">*</span> <span class="n">HAND_XSCALE</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">);</span>
</span><span class='line'>            <span class="c1">// 关节</span>
</span><span class='line'>            <span class="n">glPushMatrix</span><span class="p">();</span>
</span><span class='line'>                <span class="n">glTranslatef</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="o">-</span><span class="n">GLOBAL_SIZE</span> <span class="o">*</span> <span class="n">HAND_ZSCALE</span> <span class="o">/</span> <span class="mi">2</span><span class="p">);</span>
</span><span class='line'>                <span class="n">gluCylinder</span><span class="p">(</span><span class="n">quadratic</span><span class="p">,</span> <span class="n">GLOBAL_SIZE</span> <span class="o">*</span> <span class="n">HAND_YSCALE</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span>
</span><span class='line'>                      <span class="n">GLOBAL_SIZE</span> <span class="o">*</span> <span class="n">HAND_YSCALE</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">GLOBAL_SIZE</span> <span class="o">*</span> <span class="n">HAND_ZSCALE</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">32</span><span class="p">);</span>
</span><span class='line'>                <span class="n">glTranslatef</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="n">GLOBAL_SIZE</span> <span class="o">*</span> <span class="n">HAND_ZSCALE</span><span class="p">);</span>
</span><span class='line'>                <span class="n">drawSolidCircle</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="n">GLOBAL_SIZE</span> <span class="o">*</span> <span class="n">HAND_YSCALE</span> <span class="o">/</span> <span class="mi">2</span><span class="p">);</span>
</span><span class='line'>                <span class="n">glTranslatef</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="o">-</span><span class="n">GLOBAL_SIZE</span> <span class="o">*</span> <span class="n">HAND_ZSCALE</span><span class="p">);</span>
</span><span class='line'>                <span class="n">drawSolidCircle</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="n">GLOBAL_SIZE</span> <span class="o">*</span> <span class="n">HAND_YSCALE</span> <span class="o">/</span> <span class="mi">2</span><span class="p">);</span>
</span><span class='line'>            <span class="n">glPopMatrix</span><span class="p">();</span>
</span><span class='line'>
</span><span class='line'>            <span class="n">glRotatef</span><span class="p">((</span><span class="n">GLfloat</span><span class="p">)</span> <span class="n">leftLowerHandAngle</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">);</span>
</span><span class='line'>            <span class="n">glTranslatef</span><span class="p">(</span><span class="n">GLOBAL_SIZE</span> <span class="o">*</span> <span class="n">HAND_XSCALE</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">);</span>
</span><span class='line'>            <span class="n">glPushMatrix</span><span class="p">();</span>
</span><span class='line'>                <span class="n">glScalef</span><span class="p">(</span><span class="n">HAND_XSCALE</span><span class="p">,</span> <span class="n">HAND_YSCALE</span><span class="p">,</span> <span class="n">HAND_ZSCALE</span><span class="p">);</span>
</span><span class='line'>                <span class="n">glutSolidCube</span><span class="p">(</span><span class="n">GLOBAL_SIZE</span><span class="p">);</span>
</span><span class='line'>            <span class="n">glPopMatrix</span><span class="p">();</span>
</span><span class='line'>        <span class="n">glPopMatrix</span><span class="p">();</span>
</span><span class='line'>
</span><span class='line'>        <span class="c1">// 同理画右手</span>
</span><span class='line'>        <span class="n">glPushMatrix</span><span class="p">();</span>
</span><span class='line'>            <span class="n">glTranslatef</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">GLOBAL_SIZE</span> <span class="o">*</span> <span class="n">BODY_YSCALE</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">);</span>
</span><span class='line'>            <span class="n">glRotatef</span><span class="p">((</span><span class="n">GLfloat</span><span class="p">)</span> <span class="n">rightHigherHandAngle</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">);</span>
</span><span class='line'>            <span class="n">glTranslatef</span><span class="p">(</span><span class="n">GLOBAL_SIZE</span> <span class="o">*</span> <span class="n">HAND_XSCALE</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span>
</span><span class='line'>                   <span class="o">-</span><span class="n">GLOBAL_SIZE</span> <span class="o">*</span> <span class="p">(</span><span class="n">BODY_ZSCALE</span> <span class="o">+</span> <span class="n">HAND_ZSCALE</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">);</span>
</span><span class='line'>            <span class="n">glPushMatrix</span><span class="p">();</span>
</span><span class='line'>                <span class="n">glScalef</span><span class="p">(</span><span class="n">HAND_XSCALE</span><span class="p">,</span> <span class="n">HAND_YSCALE</span><span class="p">,</span> <span class="n">HAND_ZSCALE</span><span class="p">);</span>
</span><span class='line'>                <span class="n">glutSolidCube</span><span class="p">(</span><span class="n">GLOBAL_SIZE</span><span class="p">);</span>
</span><span class='line'>            <span class="n">glPopMatrix</span><span class="p">();</span>
</span><span class='line'>            <span class="n">glTranslatef</span><span class="p">(</span><span class="n">GLOBAL_SIZE</span> <span class="o">*</span> <span class="n">HAND_XSCALE</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">);</span>
</span><span class='line'>            <span class="c1">// Joint</span>
</span><span class='line'>            <span class="n">glPushMatrix</span><span class="p">();</span>
</span><span class='line'>                <span class="n">glTranslatef</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="o">-</span><span class="n">GLOBAL_SIZE</span> <span class="o">*</span> <span class="n">HAND_ZSCALE</span> <span class="o">/</span> <span class="mi">2</span><span class="p">);</span>
</span><span class='line'>                <span class="n">gluCylinder</span><span class="p">(</span><span class="n">quadratic</span><span class="p">,</span> <span class="n">GLOBAL_SIZE</span> <span class="o">*</span> <span class="n">HAND_YSCALE</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span>
</span><span class='line'>                      <span class="n">GLOBAL_SIZE</span> <span class="o">*</span> <span class="n">HAND_YSCALE</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">GLOBAL_SIZE</span> <span class="o">*</span> <span class="n">HAND_ZSCALE</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">32</span><span class="p">);</span>
</span><span class='line'>                <span class="n">glTranslatef</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="n">GLOBAL_SIZE</span> <span class="o">*</span> <span class="n">HAND_ZSCALE</span><span class="p">);</span>
</span><span class='line'>                <span class="n">drawSolidCircle</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="n">GLOBAL_SIZE</span> <span class="o">*</span> <span class="n">HAND_YSCALE</span> <span class="o">/</span> <span class="mi">2</span><span class="p">);</span>
</span><span class='line'>                <span class="n">glTranslatef</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="o">-</span><span class="n">GLOBAL_SIZE</span> <span class="o">*</span> <span class="n">HAND_ZSCALE</span><span class="p">);</span>
</span><span class='line'>                <span class="n">drawSolidCircle</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="n">GLOBAL_SIZE</span> <span class="o">*</span> <span class="n">HAND_YSCALE</span> <span class="o">/</span> <span class="mi">2</span><span class="p">);</span>
</span><span class='line'>            <span class="n">glPopMatrix</span><span class="p">();</span>
</span><span class='line'>
</span><span class='line'>            <span class="n">glRotatef</span><span class="p">((</span><span class="n">GLfloat</span><span class="p">)</span> <span class="n">rightLowerHandAngle</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">);</span>
</span><span class='line'>            <span class="n">glTranslatef</span><span class="p">(</span><span class="n">GLOBAL_SIZE</span> <span class="o">*</span> <span class="n">HAND_XSCALE</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">);</span>
</span><span class='line'>            <span class="n">glPushMatrix</span><span class="p">();</span>
</span><span class='line'>                <span class="n">glScalef</span><span class="p">(</span><span class="n">HAND_XSCALE</span><span class="p">,</span> <span class="n">HAND_YSCALE</span><span class="p">,</span> <span class="n">HAND_ZSCALE</span><span class="p">);</span>
</span><span class='line'>                <span class="n">glutSolidCube</span><span class="p">(</span><span class="n">GLOBAL_SIZE</span><span class="p">);</span>
</span><span class='line'>            <span class="n">glPopMatrix</span><span class="p">();</span>
</span><span class='line'>        <span class="n">glPopMatrix</span><span class="p">();</span>
</span><span class='line'>    <span class="n">glPopMatrix</span><span class="p">();</span>
</span><span class='line'>
</span><span class='line'>    <span class="n">glFlush</span><span class="p">();</span> <span class="c1">// 让OpenGL立即显示</span>
</span><span class='line'>    <span class="n">glutSwapBuffers</span><span class="p">();</span> <span class="c1">// 切换到另一个缓冲区（打开了GLUT_DOUBLE的所谓双缓冲）</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<h1>成果</h1>

<p><embed src="http://player.youku.com/player.php/sid/XNDc2NzA4NjM2/v.swf" allowFullScreen="true" quality="high" width="480" height="400" align="middle" allowScriptAccess="always" type="application/x-shockwave-flash"></embed></p>

<h1>小结</h1>

<p>这次实验是所谓的「一个星期学会OpenGL」，事实证明没有东西是不可能的，只要你想做！</p>

<p>而这次的制作虚拟人走动确实挺有趣的，比以前的项目做的那些无聊的东西好多了哈。</p>

		
		
	</div>

</article>


    <article class="post">
	<div class="meta">
		<div class="date">








  


<time datetime="2012-11-17T16:33:00+08:00" pubdate data-updated="true">Nov 17<span>th</span>, 2012</time></div>
		<div class="tags">

</div>
		
			<span class="comments"><a href="/blog/2012/11/17/bo-ke-fu-huo//index.html#disqus_thread">Comments</a></span>
		
	</div>
	<h1 class="title"><a href="/blog/2012/11/17/bo-ke-fu-huo/">博客复活</a></h1>
	<div class="entry-content">
		<h2>Hi，我复活了！</h2>

<p>之前因为重装系统的关系，博客的本地备份不小心被删掉了，而又很蛋疼地因为某些原因而不经常备份，所以整个博客都没有了。</p>

<p>在努力恢复了一些博文（这可是一个非常之烦的过程，后来就抛弃了一些认为不太重要的博文不恢复了），然后把原来的博客删掉重新部署了一个（就是你们现在看到的这个）。</p>

<h3>AnyWay..反正我回来了，有时间就写写Blog吧！</h3>

<p>大家觉得我的新主题怎么样？</p>

		
		
	</div>

</article>


    <article class="post">
	<div class="meta">
		<div class="date">








  


<time datetime="2012-10-22T13:56:00+08:00" pubdate data-updated="true">Oct 22<span>nd</span>, 2012</time></div>
		<div class="tags">


	<a class='category' href='/blog/categories/linux/'>Linux</a>


</div>
		
			<span class="comments"><a href="/blog/2012/10/22/archruan-jian-an-zhuang-xiao-ji-zhi-gnome-tweak-tool//index.html#disqus_thread">Comments</a></span>
		
	</div>
	<h1 class="title"><a href="/blog/2012/10/22/archruan-jian-an-zhuang-xiao-ji-zhi-gnome-tweak-tool/">Arch软件安装小记之“Gnome Tweak Tool”</a></h1>
	<div class="entry-content">
		<h1>前言</h1>

<p>这次毅然换了ArchLinux之后，虽然安装很快，也很快就进入了稳定使用期，但是关于软件的纠结一直存在，今天我才真正地解决了VIM的那个compile with +Python的错误问题，也顺便解决一个从安装之后一直纠结至今的问题——Python。其实归根结底是我自己的问题，我自己让自己纠结了那么久而不自知。</p>

<p>下面用GnomeTweakTool的安装过程来发泄一下。</p>

<h1>Gnome Tweak Tool</h1>

<p>安装这个东西很简单，至少在<a href="http://wiki.archlinux.org/">ArchWiki</a>上看，是的。但是我装的时候却无限纠结。</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="c"># Install the gnome-tweak-tool</span>
</span><span class='line'>sudo pacman -S gnome-tweak-tool
</span></code></pre></td></tr></table></div></figure>


<p>通常，一个普通青年的电脑就这么一句之后Gnome Tweak Tool就运行起来了，但我的不是，运行后提示：</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nv">$ </span>gnome-tweak-tool
</span><span class='line'>Trackback <span class="o">(</span>most recent call last<span class="o">)</span>:
</span><span class='line'>  File <span class="s2">&quot;usr/bin/gnome-tweak-tool&quot;</span>, line 20, in &lt;module&gt;
</span><span class='line'>    import gi
</span><span class='line'>ImportError: No module named gi
</span></code></pre></td></tr></table></div></figure>


<p>从这一句来看，它的意思就是我没装和这个<code>Module gi</code>有关的库啰，百度一查，发现要装<code>python-gobject</code>，那简单，快速地用Pacman</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>sudo pacman -S python-gobject
</span></code></pre></td></tr></table></div></figure>


<p>装完之后问题依旧。其实这里已经把我的菜鸟本质暴露无遗，应该先用<code>pacman -Ss python-gobject</code>查一下嘛。结果查出来是，<strong>python-gobject</strong>是用于Python3的，而<strong>python-gobject2</strong>才是用于Python2！！！</p>

<p>很高兴地装完<strong>python-gobject2</strong>后，问题依旧…………</p>

<h1>网上解法</h1>

<p>百度很久无果，换为Google，进入一片鸟语的海洋中。但不得不佩服Google，因为它总能找到我想要的东西！</p>

<blockquote><p>把/usr/bin/gnome-tweak-tool的第一句/usr/bin/env python2改成/usr/bin/python</p></blockquote>

<p>改了之后，确实刚才的问题解决了，因为我在Python的交互式终端里输入<code>import gi</code>发现是不报错的，所以这个解法应该是可行。但是！问题是！！它又出了一个缺少Module的提示，这次的Module为<code>gtweak</code></p>

<p>纠结，还是继续百度Google。这次是竟然无果！完全无解！无敌纠结！</p>

<h1>无意中的解决</h1>

<p>看了N页的百度谷歌，当然也学到了不少完全无关的东西，比如说<code>/usr/lib/python2.7/site-packages</code>这个文件夹里面放的就是那些引用库，我在里面竟然就发现了<code>gtweak</code>！但是Python找不到！什么原因？</p>

<p>那返回信息在我心中纠结了一天之后，某天晚上我<code>ls</code>出我的<code>/usr/bin</code>里面的文件一个一个地看，看看系统里面都有什么可执行程序时，看到了那堆<code>python</code>, <code>python2</code>,<code>python2.7</code>等等的一堆，突然灵感一现，把它改成<code>python2</code>行不行？</p>

<figure class='code'><figcaption><span>/usr/bin/gnome-tweak-tool</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="c">#!/usr/bin/python2</span>
</span><span class='line'>    ...Other codes...
</span></code></pre></td></tr></table></div></figure>


<h1>真正的问题</h1>

<p>当然，能解决的方法就是最好的方法，后来也就没管了。不过VIM一直弹Error说我在编译VIM的时候应该<code>+Python</code>，虽然不影响我日常使用，但是看起来好不爽。于是今天就下了<strong>VIM7.3</strong>的源码编译安装，顺便加了所谓<code>+Python</code>的选项</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>./configure --enable-tclinterp  --enable-rubyinterp --enable-cscope --enable-multibyte --enable-pythoninterp<span class="o">=</span>yes --enable-xim --enable-fontset --enable-gui<span class="o">=</span>auto --enable-gnome-check --enable-gtk2-check  --with-features<span class="o">=</span>huge  --with-python-config-dir<span class="o">=</span>/usr/lib/python2.7/config
</span><span class='line'>make
</span><span class='line'>sudo make install
</span></code></pre></td></tr></table></div></figure>


<p>然后看起来是完全正确的，没有找到任何问题，但是！弄完之后还是说我要+Python！我就纳闷了，不是已经+Python编译了么？还想怎样！</p>

<p>然后我正想写博喷这个问题，要装Retext，但是装完之后又是开不了，而且出错提示还是Python的。按照之前的“经验”，我果断地把<code>/usr/bin/retext</code>的头那句改成<code>/usr/bin/python2</code>然后再装了它说的依赖包<code>PyQt</code>，能打开，但是又有出错提示……</p>

<p>按理说……一个软件出问题就算了，怎么可能每个软件都出问题，而且问题表现还是类似的！</p>

<h4>又是无意的一解</h4>

<p>上面说要装<code>PyQt</code>的库，装完之后其实Retext还是找不到<code>PyQt4</code>这个库的。在<code>/usr/lib/python2.7/site-packages/</code>里面果断也找到了PyQt4，那样子问题就应该出在Python本身！</p>

<p>上面的解决问题的方法都是把<code>/usr/bin/env python2</code>改成<code>/usr/bin/python2</code>，为什么这样一改就行了呢？我在终端试了下，发现直接打<code>python2</code>然后<code>import PyQt4</code>是找不到模块，而<code>/usr/bin/python2</code>然后<code>import PyQt4</code>之后，是找得到的！！！！！</p>

<h4>曙光</h4>

<p>由上面可知，在系统环境里的<code>python2</code>并非<code>/usr/bin/python2</code>。回想起我装系统的时候是自己编译Python2，那是不是就意味着是它们的安装路径并不一样而导致系统里有两个Python2？</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>which python2
</span></code></pre></td></tr></table></div></figure>


<p>这里显示<code>/usr/local/bin/python2</code>，原来问题的症结在此！它用了我原来自已编译的Python2.7而不是Pacman所装的Python2.7！</p>

<h4>解决</h4>

<p>知道了问题所在，那么解决就容易了，直接删掉这些东西就好了</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nb">cd</span> /usr/local/bin
</span><span class='line'>rm python*
</span></code></pre></td></tr></table></div></figure>


<p>至此，问题宣告解决，Gnome-tweak-tool完美工作，Retext也是。</p>

<h1>小结</h1>

<p>这次关于系统中有两个Python2.7的问题的确纠结，但却给我以后解决问题一个很好的思路，先要想想以前自己对系统做过什么和这个问题的产生有关的事情，然后再通过测试来发现问题，Google和百度出类似的解决方案。</p>

<p>没有这次的错误，我不会知道在以后原码编译的时候<code>./configure</code>后面的参数要加<code>--prefix=/usr</code>，在装软件之前记得要先删干净系统中原来软件的残留。感谢<strong>ArchLinux</strong></p>

		
		
	</div>

</article>


    <article class="post">
	<div class="meta">
		<div class="date">








  


<time datetime="2012-04-22T13:29:00+08:00" pubdate data-updated="true">Apr 22<span>nd</span>, 2012</time></div>
		<div class="tags">


	<a class='category' href='/blog/categories/linux/'>Linux</a>


</div>
		
			<span class="comments"><a href="/blog/2012/04/22/archan-zhuang-xiao-ji//index.html#disqus_thread">Comments</a></span>
		
	</div>
	<h1 class="title"><a href="/blog/2012/04/22/archan-zhuang-xiao-ji/">Arch安装小记</a></h1>
	<div class="entry-content">
		<h1>前言</h1>

<p>这次安装<strong>ArchLinux</strong>的冲动来自于<strong>LPY师弟</strong>，这个技术宅师弟喜欢钻研东西，还有<strong>Maple师兄</strong>。他们都建议我说用<strong>ArchLinux</strong>更加深入底层，有更多的机会去定制和体验过程，对于学习很有好处。当然这个其中一个原因，另外一个原因就是有一个很坑的<a href="http://www.zegeniestudios.net/ldc/">测试你最适合用哪个Linux发行版</a>的测试，得出的结果是</p>

<blockquote><p>Ubuntu 100%
OpenSUSE 100%
Mandriva 100%
…下面就是LinuxMint，Fedora…</p></blockquote>

<p>反正意思就是，我最好还是用一些比较高级的发行版，Gentoo、Arch这些发行版还是不适合我的= =。看了之后很不爽，浑身都不爽。于是拿起U盘向<strong>Zero</strong>拿了个<strong>ArchLinux i686</strong>版本写到盘上然后二话不说就把Ubuntu 11.10的盘全格了重新分了区。虽然是有点冲动，冲动得就只保存了<code>.vimrc</code>和<code>.vim</code>和<strong>eclipse</strong>的workspace就马上全盘格掉！</p>

<h1>准备工作</h1>

<p>首先当然是要先去<a href="http://http//www.archlinux.org/">官网</a>下一个iso了。它分成三种，i686(32-bit), x86_64(amd64), Dual Architecture(x86 + x86_64合体).</p>

<p>下了得到个iso，然后写入U盘里。当然你可以刻成碟..。刻入U盘的方法很多，可以用一个通用的方法</p>

<p>&#8220;bash
dd if=iso_name of=/dev/sd&#8221;x&#8221;</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>
</span><span class='line'>其中，“x“必须是a, b, c, …，不要写成sdb1…因为是要写到整个U盘中去，所以要先备份一下。
</span><span class='line'>
</span><span class='line'>然后，那就是备份一下当前系统中的东西了。如果是已经把`/home`单独作一个分区的话，可以不用格掉那个分区但是还是备份一下为妙。
</span><span class='line'>
</span><span class='line'>最后，看一下你的硬盘分区记录，记一下哪个是sda1, sda2, sda3 ….
</span><span class='line'>
</span><span class='line'>THEN, 重启，插入，设BIOS，开机…
</span><span class='line'>
</span><span class='line'># 安装
</span><span class='line'>**ArchLinux**的安装和**Ubuntu**、**Fedora**、**OpenSUSE**的安装过程不太一样（我又想起了那个测试），基本上都是一个蓝底界面操作，不过玩久了还是很容易看懂的。建议先看[ArchWiki](https://wiki.archlinux.org/index.php/Main_Page)然后再装。
</span><span class='line'>
</span><span class='line'>直接在引导界面那里点Arch Linux，然后就会进入到U盘里面的那个系统里，默认就是以root登录的。那么就可以直接执行
</span></code></pre></td></tr></table></div></figure>


<p>bash
/arch/setup</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>
</span><span class='line'>然后就直接进入了安装程序。我是用core版的iso安装的，所以安装过程不用连网，如果是下了net版的，那可以看一下Wiki的相应部分。
</span><span class='line'>
</span><span class='line'>刚开始是设置时钟（UTC），设置编辑器（vi），括号是我的选择
</span><span class='line'>
</span><span class='line'>然后便是分区。这个工具真用来分区的话就太不好用了。所以我是在安装之前用Ubuntu的分区工具先分好区然后再过来装。如果是直接在这里装，那可以在运行`/arch/setup`之前运行`fdisk`来分区（用Alt+F3切换到另一个虚拟控制台）。在选项中
</span><span class='line'>
</span><span class='line'>* Auto-Prepare（使用整个硬盘，安装程序给你分区，极不推荐）
</span><span class='line'>* Manually partition hard drives（手动配置硬盘，就是在这里分区）
</span><span class='line'>* Manually configure block devices, filesystems and mountpoints（手动配置块设备、文件系统和挂载点）
</span><span class='line'>* Roolback last filesystem changes（撤销最后更改）
</span><span class='line'>
</span><span class='line'>这些步骤完了之后就进到下一部，**选择软件包**
</span><span class='line'>
</span><span class='line'>* 首先选择GRUB还是syslinux作为启动加载器，我先GRUB
</span><span class='line'>* 然后选软件包组，有两个
</span><span class='line'>
</span><span class='line'>  * base 来自[core]软件源的最小基本系统，总是选中它并删除不用的软件包
</span><span class='line'>  * base-devel 除了上面的工具还有附加工具如make和automake，建议用这个。（我进去之后还把其它所有的都选上了）
</span><span class='line'>
</span><span class='line'>然后就安装软件包了，这个过程是等得最久的，5分钟左右。
</span><span class='line'>
</span><span class='line'>然后就配置系统，因为**Arch之道**倡导纯粹性和开放性，不向用户隐藏任何过程，所以就一个一个配置文件给你过目之后再写入。通过看这些配置文件，你发现你会更加深入了解系统的最基本配置。
</span><span class='line'>
</span><span class='line'>#### /etc/rc.conf
</span><span class='line'>**ArchLinux**使用`/etc/rc.conf`作为系统的主要配置文件。这个文件包含了广泛的配置信息，主要用于系统的启动。正如文件所说，它还包含了供`/etc/rc*`使用的配置信息。
</span><span class='line'>
</span><span class='line'>#### LOCALIZATION部分
</span><span class='line'>* LOCALE 是系统本地化设置，所有国际化的应用程序都会使用这个设置。运行locale -a可以显示可用设置。默认是en_US.UTF-8，如果要改成中文那就是zh_CN.UTF-8，但建议先不要改，因为虚拟控制台是不支持中文的，装了X之后再改也不迟
</span><span class='line'>* DAEMON_LOCALE 是否使用本地daemon，是yes那就是用$LOCALE作为环境变量
</span><span class='line'>* HARDWARECLOCK 刚才设的UTC
</span><span class='line'>* TIMEZONE 刚才设的时区
</span><span class='line'>* KEYMAP 默认是us
</span><span class='line'>* CONOLEFONT 控制台用的字体
</span><span class='line'>* CONSOLEMAP 定义了启动时setfont程序加载的控制台映射表
</span><span class='line'>* USECOLOR 如果用的是彩色显示器那就是“yes”
</span><span class='line'>
</span><span class='line'>我的LOCALIZATION
</span></code></pre></td></tr></table></div></figure>


<p>bash
LOCALE=”en_US.UTF-8”
DAEMON_LOCALE=”no”
HARDWARECLOCK=”UTC”
TIMEZONE=”Asia/Hong_Kong”
KEYMAP=”us”
CONSOLEFONT=
CONSOLEMAP=
USECOLOR=”yes”</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>
</span><span class='line'>#### HARDWARE部分
</span><span class='line'>* MODULES 可以在这里指定缺少那个模块
</span><span class='line'>
</span><span class='line'>可以暂时什么都不写。
</span><span class='line'>
</span><span class='line'>#### NETWORKING部分
</span><span class='line'>* HOSTNAME 随意设置，你的主机名字
</span><span class='line'>* 然后设置网络，在宿舍用校园网的话直接用dhcp设置，即只需要interface=eth0
</span><span class='line'>
</span><span class='line'>#### DAEMONS部分
</span><span class='line'>开机需要启动的脚本名字
</span><span class='line'>
</span><span class='line'>* 如果脚本名字前有！号，表示它不被执行
</span><span class='line'>* 如果脚本名字前有@符号，则表示它会在后台被执行，即启动序列不等待脚本运行成功就会继续执行下一个脚本
</span><span class='line'>
</span><span class='line'>后面安装图形界面之后还会用到这个序列
</span><span class='line'>
</span><span class='line'>#### /etc/fstab
</span><span class='line'>这个文件来用指定启动挂载的磁盘和分区
</span><span class='line'>
</span><span class='line'>**接下来的基本都可以不用修改直接保存**
</span><span class='line'>
</span><span class='line'>#### /etc/locale.gen
</span><span class='line'>这个文件是被命令`locale-gen`所读取，记录系统的locales信息，这些设置会用于本地化程序用于本地化显示。选出**zh_CN**的行，把前面的#移除就行。
</span><span class='line'>
</span><span class='line'>#### /etc/pacman.conf
</span><span class='line'>pacman在会每启动时都访问这个文件，这个文件定义了源和段（options），直接删除一些`include=`和`[repository]`前面的#号删掉就可以启用对应的源
</span><span class='line'>
</span><span class='line'>安装的时候，默认设置就行了。
</span><span class='line'>
</span><span class='line'>#### /etc/pacman.d/mirrorlist
</span><span class='line'>看名字就知道，这个是为**pacman**选择镜像的文件，上面已经写好了一些**China**的镜像源，有两个教育网源，晚上更新非常快。
</span><span class='line'>
</span><span class='line'>#### Root密码
</span><span class='line'>这就不用解释了
</span><span class='line'>
</span><span class='line'>#### 安装启动加载器，即GRUB
</span><span class='line'>同样，安装程序也把`/boot/grub/menu.lst`放出来给你过目。如果有windows，那就把最后那段关于win的引导注释弄掉，那就可以注释了。它默认是在首分区，如果你的win在首分区，那就不用改，不然就要改一下`root (hd0, 0)`
</span><span class='line'>
</span><span class='line'>**OK，到这里就算装完了系统了，回到界面，reboot重启，把U盘拔了就行。**
</span><span class='line'>
</span><span class='line'># 进入系统
</span><span class='line'>进入系统之后要登录，那肯定是只有root
</span><span class='line'>
</span><span class='line'>登录之后先连网。怎么连？如果要连无线，那就要看看**ArchWiki**里面的相关说明。我在安装的时候并未能识别我的无线网卡，所以我是采用连校园网的方式上网的。
</span><span class='line'>
</span><span class='line'>## 连接校园网
</span><span class='line'>连接校园网，首先就要使用一个客户端[YaH3C](https://github.com/humiaozuzu/YaH3C)，用GIT把它CLONE到本地，然后保存在U盘上。
</span><span class='line'>
</span><span class='line'>YaH3C是使用Python2.x的，所以要运行它还得装Python（Arch并不自带），所以还要到[Python官网](http://python.org/)下一个2.7.3的源码包，也放到U盘里。
</span><span class='line'>
</span><span class='line'>OK，准备完毕，开始装YaH3C
</span><span class='line'>
</span><span class='line'>#### 安装Python2.7.3和YaH3C
</span><span class='line'>先把U盘插进电脑，然后把它挂载到一个地方（我用`/media/CONVEYOR`）
</span></code></pre></td></tr></table></div></figure>


<p>bash
mount /dev/sdb1 /media/CONVEYOR</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>
</span><span class='line'>然后把它们都制到主文件夹并解压安装（因为没有装相关的对U盘的FAT文件系统的东西，所以是不能往里面写）
</span></code></pre></td></tr></table></div></figure>


<p>bash
cp -r YaH3C ~
cp Python-2.7.3.tgz ~
cd ~
tar -xvf Python-2.7.3.tgz</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>
</span><span class='line'>最后当然就是安装这两个了，先安装Python
</span></code></pre></td></tr></table></div></figure>


<p>bash
cd Python-2.7.3
./configure
make
make install</p>

<h1>上面过程比较久，可以找点东西做做</h1>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>
</span><span class='line'>然后为了以后使用，先加一个用户，增加用户用`adduser`，增加用户组用`groupadd`
</span><span class='line'>
</span><span class='line'>然后把新建的用户加入`sudoers`，就是向`/etc/sudoers`里面加
</span><span class='line'>
</span><span class='line'>  username    ALL=(ALL) ALL
</span><span class='line'>
</span><span class='line'>然后`exit`，用你的用户名登录，再运行`sudo yah3c`，如无意外，是可以登录的！
</span><span class='line'>
</span><span class='line'>登录之后，还要一步`sudo dhcpcd eth0`，这就可以上网了！！
</span><span class='line'>
</span><span class='line'># 更新
</span><span class='line'>由于iso是2011年的了，所以现在已经有很多的更新，那就先更新了系统再说。
</span><span class='line'>
</span><span class='line'>先修改`/etc/pacman.conf`，将SigLevel设为”Never”，没有就手动加上（我装x86_64版的时候发现默认没有，而i686版默认就是Never）
</span><span class='line'>
</span><span class='line'>然后执行
</span></code></pre></td></tr></table></div></figure>


<p>bash
pacman-key &#8211;init
pacman -S filesystem &#8211;force
rm /etc/profile.d/locale.sh
pacman -Syu</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>
</span><span class='line'>我在`pacman-key --init`这一步一直卡着不能过，于是就直接跳过了，发现也可以用，可能与SigLevel="Never"有关吧。
</span><span class='line'>**2012-10-22更新：其实是因为没有收集到足够的随机数据，遇到这种问题时先执行`pacman-key --init`然后在键盘乱按「要乱按很久」，记住是乱按，然后就能生成了**
</span><span class='line'>
</span><span class='line'>它会先升级**pacman**然后再升级系统，这里慢慢等上一段时间，深夜速度很快！
</span><span class='line'>
</span><span class='line'># 装Gnome3
</span><span class='line'>在装这个之前我也装了不少东西，比如vim什么的先装好，那样就不用去用那个无比简陋的vi了。
</span><span class='line'>
</span><span class='line'>#### 安装基础安装包
</span><span class='line'>Xorg
</span></code></pre></td></tr></table></div></figure>


<p>bash
pacman -S xorg-server xorg-xinit xorg-utils xorg-server-utils</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>mesa用于3D支持，3D工具glxgears和glxinfo都在mesa-demos里
</span></code></pre></td></tr></table></div></figure>


<p>bash
pacman -S mesa mesa-demos</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>
</span><span class='line'>安装显卡驱动
</span><span class='line'>
</span><span class='line'>* 先通过lspci看看你的是什么显卡
</span><span class='line'>* 通过`pacman -Ss xf86-video`看看有什么开源驱动可以用
</span><span class='line'>
</span><span class='line'>如果是用intel集显，那就可以装`xf86-video-intel`，或者是`xf86-video-ati`或`xf86-video-nv`，如果是想装闭源驱动，可以看**ArchWiki**相应部分，我直接用集显，然后把独显关掉，省电而且发热少。
</span><span class='line'>
</span><span class='line'>安装输入设备，笔记本要装触摸驱动
</span></code></pre></td></tr></table></div></figure>


<p>bash
pacman -S xf86-input-synaptics</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>
</span><span class='line'>装测试用的基本图形界面
</span></code></pre></td></tr></table></div></figure>


<p>bash
pacman -S xorg-twm xorg-xclock xterm
rm ~/.xinit</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>
</span><span class='line'>安装消息总线DBUS
</span></code></pre></td></tr></table></div></figure>


<p>bash
pacman -S dbus</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>
</span><span class='line'>然后现在就可以直接执行`startx`，理论上应该能看到一个简单的图形界面，上面有一些简单的可移动窗口和鼠标。如果验证完之后，在那个终端上输入`exit`就能退出。
</span><span class='line'>
</span><span class='line'>&gt; 黑了屏怎么办？重启吧…
</span><span class='line'>
</span><span class='line'>#### 安装字体和Gnome
</span></code></pre></td></tr></table></div></figure>


<p>bash
pacman -S ttf-dejavu wqy-zenhei gnome gnome-extra gdm</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>
</span><span class='line'>其中`gnome-extra`可以选择一些你觉得有用的组件来装
</span><span class='line'>
</span><span class='line'>写入`~/.xinitrc`启动gnome-session
</span></code></pre></td></tr></table></div></figure>


<p>sh</p>

<h1>ONLY THIS LINE</h1>

<p>exec ck-launch-session gnome-session</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>
</span><span class='line'>&gt; 如果是x86_64，那么中间的ck-launch-session就不用写了
</span><span class='line'>
</span><span class='line'># 启动Gnome3！
</span><span class='line'>如无意外，直接执行`startx`即可启动Gnome3！
</span><span class='line'>
</span><span class='line'>可能刚进去是一个Fallback的状态，那么可以Logout一下再进一次，就可以了。如果一直是Fallback状态，那可能驱动装得有问题。
</span><span class='line'>
</span><span class='line'>记得，不是用root来执行`startx`的。
</span><span class='line'>
</span><span class='line'># 配置Gnome3
</span><span class='line'>#### 修改/etc/inittab
</span><span class='line'>
</span><span class='line'>  改动1：
</span><span class='line'>  ## Only one of the following two lines can be uncommented!
</span><span class='line'>  # Boot to console
</span><span class='line'>  #id:3:initdefault:
</span><span class='line'>  # Boot to X11
</span><span class='line'>  id:5:initdefault:
</span><span class='line'>  
</span><span class='line'>  改动2：
</span><span class='line'>  # Example lines for starting a login manager
</span><span class='line'>  #x:5:respawn:/usr/bin/xdm -nodaemon
</span><span class='line'>  x:5:respawn:/usr/sbin/gdm -nodaemon
</span><span class='line'>  #x:5:respawn:/usr/bin/kdm -nodaemon
</span><span class='line'>  #x:5:respawn:/usr/bin/slim &gt;/dev/null 2&gt;&1
</span><span class='line'>
</span><span class='line'>#### /etc/rc.conf
</span><span class='line'>
</span><span class='line'>  （1）中文化
</span><span class='line'>  LOCALE="zh_CN.UTF-8"
</span><span class='line'>  #LOCALE="en_US.UTF-8"
</span><span class='line'>  DAEMON_LOCALE="no"
</span><span class='line'>  HARDWARECLOCK="localtime"
</span><span class='line'>  TIMEZONE="Asia/Shanghai"
</span><span class='line'>  
</span><span class='line'>  （2）将开机加载的模块添加到MODULES的模块中。
</span><span class='line'>  MODULES=(fuse )
</span><span class='line'>  
</span><span class='line'>  （3）开机启动服务。@代表在后台（background）运行。
</span><span class='line'>  DAEMONS=(hwclock syslog-ng dbus network netfs crond gdm @networkmanager )
</span><span class='line'>
</span><span class='line'>安装读写ntfs分区的`ntfs-3g`
</span></code></pre></td></tr></table></div></figure>


<p>bash
pacman -S ntfs-3g
&#8220;`</p>

<p><strong>Ok，现在是装完了，reboot试试？</strong></p>

<h1>后记</h1>

<p>这次冲动安装ArchLinux也不是完全没有准备的，在之前就一直在虚拟机上面玩Arch，对它的一些命令也算是用过，不陌生。另外在最近一直在看ArchWiki的东西，所以安装起来并不是太费力。主要出的问题在于安装YaH3C的时候（这个是失误，没有用最新版的YaH3C），然后就是安装图形界面时候的事。在Wiki上<code>.xinitrc</code>里面写的是有那个<code>ck-launch-session</code>，在装完<code>x86_64</code>系统之后呢就发现这样子直接<code>startx</code>是不能成功启动图形界面的，在这里纠结了许久，排除了各种原因之后，最终万念俱灰的时候就想去试试把这句删了会怎样，结果删了就行了。</p>

<p>这次的安装看上去好像步骤不多，但我是从昨天晚上10点左右开始准备装，到今天下午5点多才宣告软件完全装好。所以系统还是不要乱重装，毕竟比较麻烦。而且时间大多都花在适应Arch上，因为以前在Ubuntu下用Apt-get可以把大多数的事情都帮我做好，而现在用pacman装的话，基本上就只会给我装好了软件包，而配置工作就交给我了。而且还有一些奇奇怪怪的问题会出现，翻了N页Google之后还是无果，解决还得靠自己的创造力，想想可能会是什么原因然后再换个方向去搜，最后恍然大悟的感觉非常的爽，让人非常享受。</p>

<p>下一篇，讲一下记录着我安装其它软件时遇到的小问题及解决方法。</p>

		
		
	</div>

</article>


    <article class="post">
	<div class="meta">
		<div class="date">








  


<time datetime="2012-04-17T13:25:00+08:00" pubdate data-updated="true">Apr 17<span>th</span>, 2012</time></div>
		<div class="tags">


	<a class='category' href='/blog/categories/algorithm-/'>Algorithm,</a>, <a class='category' href='/blog/categories/sicily/'>Sicily</a>


</div>
		
			<span class="comments"><a href="/blog/2012/04/17/soj-1211-dot-shang-ren-de-xuan-chuan-ti-jie//index.html#disqus_thread">Comments</a></span>
		
	</div>
	<h1 class="title"><a href="/blog/2012/04/17/soj-1211-dot-shang-ren-de-xuan-chuan-ti-jie/">SOJ 1211.商人的宣传 题解</a></h1>
	<div class="entry-content">
		<h1>Description</h1>

<p>Bruce是K国的商人，他在A州成立了自己的公司，这次他的公司生产出了一批性能很好的产品，准备宣传活动开始后的第L天到达B州进行新品拍卖，期间Bruce打算将产品拿到各个州去做推销宣传,以增加其影响力。</p>

<p>K国有很多个州,每个州都与其他一些州相邻,但是K国对商人作宣传却有一些很奇怪的规定：</p>

<p>1、 商人只能从某些州到达另外一些州，即连通路线是单向的，而且有些州可能是到达不了的。</p>

<p>2、 商人不允许在同一个州连续宣传两天或以上，每天宣传完必须离开该州。</p>

<p>3、 商人可以多次来到同一个州进行宣传。</p>

<p>“我必须找出一条影响力最大的路线才行”，Bruce想，”但我首先必须知道到底有多少这种符合规定的宣传路线可供我选择。”现在Bruce把任务交给了你。并且出于考虑以后的需要，你还要帮他算出给出的两州之间的路线的总数。</p>

<h1>Input</h1>

<p>输入文件第一行包含三个整数n,m,L（1≤n,L≤100），分别表示K国的州数、连通路线的数量，以及多少天后必须到达B州。接下来有m行，每行一队整数x,y（1≤x,y≤n），表示商人能从x州到达y州。</p>

<p>第m+2行为一个整数q（1≤q≤100），表示Bruce有q个询问。下面q行每行两个整数A,B（1≤A,B≤n），即A、B州的位置。</p>

<h1>Output</h1>

<p>输出文件包含q行，每行一个整数t，为所求的从A州到B州满足上述规定的路线总数。</p>

<p>输入数据中的询问将保证答案t在长整数范围内，即t&lt;2<sup>31。</sup></p>

<h1>Sample Input</h1>

<p>4 5 6</p>

<p>1 2</p>

<p>2 3</p>

<p>3 4</p>

<p>4 1</p>

<p>2 4</p>

<p>2</p>

<p>1 4</p>

<p>4 2</p>

<h1>Sample Output</h1>

<p>2</p>

<p>1</p>

<h1>Solving</h1>

<p>题意已经很很显然了，那就直入正题，如何解决这个题目？</p>

<p>题目一看就是一个找路的问题，但难点在于如何找出所有可以走的路和对于每一个询问都能迅速地给出答案。</p>

<p>为了应对多个询问，那必须要有预处理，在接受完路线图的输入之后，马上把所有可能问到的A与B之间的路线总数都算出来存在一个数据结构中。</p>

<p>计算每个A到B之间的路线，可以用分治的思想，把大问题化小，利用之前已计算过的结果结合得出更远的两个城市之间的结果。</p>

<h1>Code</h1>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
</pre></td><td class='code'><pre><code class='cpp'><span class='line'><span class="cp">#include &lt;cstdio&gt;</span>
</span><span class='line'><span class="cp">#include &lt;stack&gt;</span>
</span><span class='line'><span class="cp">#include &lt;vector&gt;</span>
</span><span class='line'><span class="cp">#include &lt;memory.h&gt;</span>
</span><span class='line'><span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'><span class="k">struct</span> <span class="p">{</span>
</span><span class='line'>    <span class="kt">int</span> <span class="n">u</span><span class="p">;</span>
</span><span class='line'>    <span class="kt">int</span> <span class="n">v</span><span class="p">;</span>
</span><span class='line'><span class="p">}</span> <span class="n">w</span><span class="p">[</span><span class="mi">10010</span><span class="p">];</span>
</span><span class='line'>
</span><span class='line'><span class="kt">int</span> <span class="n">main</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>    <span class="kt">int</span> <span class="n">f</span><span class="p">[</span><span class="mi">110</span><span class="p">][</span><span class="mi">110</span><span class="p">][</span><span class="mi">110</span><span class="p">];</span>
</span><span class='line'>    <span class="kt">int</span> <span class="n">n</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">l</span><span class="p">;</span>
</span><span class='line'>    <span class="kt">int</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">;</span>
</span><span class='line'>    <span class="n">memset</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">f</span><span class="p">));</span>
</span><span class='line'>    <span class="n">scanf</span><span class="p">(</span><span class="s">&quot;%d%d%d&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">n</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">m</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">l</span><span class="p">);</span>
</span><span class='line'>    <span class="kt">int</span> <span class="n">v</span><span class="p">,</span> <span class="n">u</span><span class="p">;</span>
</span><span class='line'>    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">m</span><span class="p">;</span> <span class="o">++</span> <span class="n">i</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>        <span class="n">scanf</span><span class="p">(</span><span class="s">&quot;%d%d&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">w</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">u</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">w</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">v</span><span class="p">);</span>
</span><span class='line'>        <span class="n">f</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">w</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">u</span><span class="p">][</span><span class="n">w</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">v</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>    <span class="kt">int</span> <span class="n">q</span><span class="p">;</span>
</span><span class='line'>    <span class="n">scanf</span><span class="p">(</span><span class="s">&quot;%d&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">q</span><span class="p">);</span>
</span><span class='line'>    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">l</span><span class="p">;</span> <span class="o">++</span> <span class="n">i</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="p">;</span> <span class="o">++</span> <span class="n">j</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>            <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">k</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">k</span> <span class="o">&lt;=</span> <span class="n">m</span><span class="p">;</span> <span class="o">++</span> <span class="n">k</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>                <span class="n">f</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">][</span><span class="n">w</span><span class="p">[</span><span class="n">k</span><span class="p">].</span><span class="n">v</span><span class="p">]</span> <span class="o">+=</span> <span class="n">f</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">][</span><span class="n">j</span><span class="p">][</span><span class="n">w</span><span class="p">[</span><span class="n">k</span><span class="p">].</span><span class="n">u</span><span class="p">];</span>
</span><span class='line'>                <span class="c1">//printf(&quot;f[%d][%d][%d]=%d %d\n&quot;, i, j, w[k].v, f[i][j][w[k].v], f[i - 1][j][w[k].u]);</span>
</span><span class='line'>            <span class="p">}</span>
</span><span class='line'>        <span class="p">}</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>    <span class="k">while</span><span class="p">(</span><span class="n">q</span> <span class="o">--</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>        <span class="n">scanf</span><span class="p">(</span><span class="s">&quot;%d%d&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">a</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">b</span><span class="p">);</span>
</span><span class='line'>        <span class="n">printf</span><span class="p">(</span><span class="s">&quot;%d</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">f</span><span class="p">[</span><span class="n">l</span><span class="p">][</span><span class="n">a</span><span class="p">][</span><span class="n">b</span><span class="p">]);</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


		
		
	</div>

</article>


    <article class="post">
	<div class="meta">
		<div class="date">








  


<time datetime="2012-04-15T13:17:00+08:00" pubdate data-updated="true">Apr 15<span>th</span>, 2012</time></div>
		<div class="tags">


	<a class='category' href='/blog/categories/embedded-/'>Embedded,</a>, <a class='category' href='/blog/categories/linux/'>Linux</a>


</div>
		
			<span class="comments"><a href="/blog/2012/04/15/qian-ru-shi-linuxxue-xi-si-lu-ji-can-kao-zi-liao-arm-plus-linuxlu-xian//index.html#disqus_thread">Comments</a></span>
		
	</div>
	<h1 class="title"><a href="/blog/2012/04/15/qian-ru-shi-linuxxue-xi-si-lu-ji-can-kao-zi-liao-arm-plus-linuxlu-xian/">嵌入式Linux学习思路及参考资料(ARM+LINUX路线)</a></h1>
	<div class="entry-content">
		<h1>嵌入式人才需求</h1>

<ol>
<li><strong>嵌入式应用工程师</strong>：主要面向计算机、软件工程相关专业。其基于某个平台，例如嵌入式Linux、Vxworks、WinCE的上层应用软件开发，开发语言主要采用嵌入式C/C++，主要领域网络、图形、数据库、音频、视频处理等。</li>
<li>嵌入式系统工程师：主要面向电子信息相关专业，基于某个处理器内核，例如ARM、MIPS、PPC等，主要开发语言为汇编语言及嵌入式C语言编程，主要从事BootLoader、操作系统及中间件移植等工作。</li>
<li><strong>嵌入式驱动工程师</strong>：主要面向电子信息、计算机相关专业，基于某个处理器，例如2410、2440、6410等平台，开发语言主要为嵌入式C语言，主要从事接口驱动</li>
</ol>


<h2>嵌入式学生都应具备以下基本能力</h2>

<ol>
<li><strong>至少</strong>一种嵌入式处理器（ARM）</li>
<li><strong>至少</strong>一种嵌入式操作系统（LINUX）</li>
<li>一套嵌入式开发工具（ADS、GCC、嵌入式交叉编译调试环境）</li>
<li>一类开发语言（ARM汇编、C/C++）</li>
</ol>


<p>另外，必须熟悉嵌入式软件开发流程并至少做一个嵌入式软件项目。</p>

<h1>从事嵌入式软件开发的好处</h1>

<ol>
<li>目前国内外这方面的人都很<strong>稀缺</strong></li>
<li>与企业计算等应用软件不同，嵌入式领域人才的工作强度通常低一些（但收入不低）</li>
<li>嵌入式不像应用软件那样容易被盗版</li>
</ol>


<h1>从事嵌入式软件开发的缺点</h1>

<ol>
<li><strong>入门起点较高</strong>，所用到的技术往往都有一定的难度，若软硬件基础不好，特别是操作系统级软件功底不深，则可能不适于此行。</li>
<li>这方面的企业数量要<strong>远少</strong>于企业计算类企业</li>
<li>有少数公司经常要硕士以上的人搞嵌入式，主要是基于嵌入式的难度，但大多数公司也并无此要求，只要有经验即可</li>
<li>平台依托强，换平台比较辛苦</li>
</ol>


<h1>方法步骤</h1>

<h2>1. 基础知识</h2>

<ul>
<li>数字电路</li>
<li>计算机组成原理</li>
<li>C/C++，嵌入式C</li>
<li>数据结构和算法</li>
<li>操作系统</li>
<li>网络</li>
<li>数据库</li>
</ul>


<p><strong>C语言参考书：</strong>
* The C++ Programming Language
* Pointers on C
* C traps and pitfalls
* Expert C Language</p>

<h2>2. Linux学习</h2>

<blockquote><p>使用Linux Linux应用编程开发 驱动开发和分析Linux内核</p></blockquote>

<p><strong>Linux基础参考书：</strong>
* 《Linux与Unix Shell编程指南》
* 《Red Head Linux 9系统管理与服务器配置》人民邮电出版社</p>

<p><strong>Linux应用编程开发：</strong>
* 《UNIX Network Programming（第3版）》机械工业出版社 网络编程用
* 《UNIX环境高级编程（第2版）》清华大学出版社 系统调用及编程工具书
* 《Linux高级程序设计（第2版）》人民邮电出版社 杨宗德 系统调用及编程，有很多救命，初学者很不错</p>

<p><strong>驱动开发和分析Linux内核：</strong>
* 《Linux内核设计与实现》陈莉君 机械工业出版社
* 《Linux设备驱动开发》中国电力出版社</p>

<h2>ARM＋Linux嵌入式系统开发</h2>

<p><strong>ARM基础学习</strong></p>

<ul>
<li>《嵌入式ARM系统原理与实例开发（第2版）》北京大学出版社
*《ARM体系结构与编程》杜春雷</li>
<li>S3C2410 Datasheet</li>
</ul>


<p><strong>嵌入Linux开发</strong>
买块板子，调试程序</p>

<blockquote><p>其实很多人有误区，觉得学嵌入式要有板子，在后期确实如此，但如果基础达不到，也就把例子拿来跑跑，只有以上基础，基本功达到才能够真正开发</p></blockquote>

<h2>深入学习</h2>

<ol>
<li>数字图像压缩技术：主要是应掌握MPEG、MP3等编解码算法和技术</li>
<li>通信协议及编程技术：TCP/IP协议、802.11、Bluetooth、GPRS、GSM、CDMA等</li>
<li>网络与信息安全技术：如加密技术、数据证书CA等</li>
<li>DSP（Digital Signal Process）技术，DSP处理器通过硬件实现数字信号处理算法</li>
</ol>


<h1>引用</h1>

<p>本文引用自<a href="http://www.mcuos.com/thread-5302-1-1.html">嵌入式开发联盟网版主</a>osboy的文章《嵌入式Linux学习思路及参考资料（ARM+LINUX路线）》</p>

		
		
	</div>

</article>


    <article class="post">
	<div class="meta">
		<div class="date">








  


<time datetime="2012-04-14T18:17:00+08:00" pubdate data-updated="true">Apr 14<span>th</span>, 2012</time></div>
		<div class="tags">

</div>
		
			<span class="comments"><a href="/blog/2012/04/14/octopresszhu-ti-ji.markdown//index.html#disqus_thread">Comments</a></span>
		
	</div>
	<h1 class="title"><a href="/blog/2012/04/14/octopresszhu-ti-ji.markdown/">Octopress主题集</a></h1>
	<div class="entry-content">
		<p>与其它博客系统一样，Octopress也有主题功能。如果你有JavaScript与CSS编写能力的话，照着默认主题自己写一个应该不太难。但是我只会一点JavaScript皮毛，会看不会写。</p>

<p>这也就让我有迫切的需求要装一个主题来美化一下我的博客，不懂的话利用其它大神们的劳动成果是唯一的方法，那问题来了，拿到了主题之后怎么装呢？</p>

<h1>安装Octopress主题</h1>

<p>通过一轮搜索之后发现，Octopress的主题一般都是放在github上托管的，那么这类主题的安装方法是：</p>

<ul>
<li>首先找到这个主题的github地址，比如我这个博客用的主题是<code>https://github.com/bkutil/bootstrap-theme.git</code></li>
<li><p>然后用git的clone方法把它下载到你本地博客根目录的.themes文件夹中：</p>

<pre><code>  $ git clone https://github.com/bkutil/bootstrap-theme.git ./.themes/bootstrap-theme
</code></pre></li>
<li><p>下完之后你会发现在.themes文件夹下多了个bootstrap-theme文件夹，这就是主题</p></li>
<li><p>然后我们要安装，执行<code>rake install['主题名']</code>就可以安装了，在这个例子里面就是：</p>

<pre><code>  rake install['bootstrap-theme']
</code></pre></li>
<li><p>最后当然要<code>rake generate</code>，然后预览一下<code>rake preview</code>，感觉不错之后就可以上传了</p></li>
</ul>


<h1>几款主题推荐</h1>

<p>在Octopress的github上，推荐了一些主题，其中几个都挺不错的，可以看一看</p>

<blockquote><p>List of Octopress Themes</p>

<p>https://github.com/imathis/octopress/wiki/List-Of-Octopress-Themes</p></blockquote>

<h2>Bootstrap-theme</h2>

<h4>Another Twitter Bootstrap based theme <a href="http://bootstrap-theme.kutilovi.cz/">preview</a></h4>

<p>这个就是你正在看的这个博客所用的主题，个人感觉还不错</p>

<h2>slash</h2>

<p>轻量级的主题，小清新 <a href="http://zespia.tw/Octopress-Theme-Slash/">preview</a></p>

<p><img src="/images/artical-image/slash-preview.png" alt="Alt text" /></p>

<h2>object-octopress-theme</h2>

<p>极简的主题，感觉非常不错 <a href="http://k.ernel.org">preview</a></p>

<h2>MrZhang.me</h2>

<p>一个中国人写的主题，风格比较像记事博客 <a href="http://mrzhang.me/blog/blog-equals-github-plus-octopress.html">preview</a></p>

<h2>compbits</h2>

<p>看起来比较有科技感 <a href="http://blog.iwinux.info/">preview</a></p>

		
		
	</div>

</article>


    <article class="post">
	<div class="meta">
		<div class="date">








  


<time datetime="2012-04-14T16:55:00+08:00" pubdate data-updated="true">Apr 14<span>th</span>, 2012</time></div>
		<div class="tags">


	<a class='category' href='/blog/categories/octopress/'>Octopress</a>, <a class='category' href='/blog/categories/github/'>github</a>


</div>
		
			<span class="comments"><a href="/blog/2012/04/14/octopressan-zhuang-shou-ji//index.html#disqus_thread">Comments</a></span>
		
	</div>
	<h1 class="title"><a href="/blog/2012/04/14/octopressan-zhuang-shou-ji/">Octopress安装手记</a></h1>
	<div class="entry-content">
		<h1>前言</h1>

<p>本来我是想主攻<strong>底层操作系统方向</strong>和<strong>嵌入式软件设计</strong>，理应和WEB没什么关系，但是前几天<strong>Maplist</strong>大神准许我加入去维护一个MAC服务器，要我们去尝试在服务器上搭博客玩，于是就手痒找资料。</p>

<p>刚开始就在SAE（Sina App Engine）上面搭了个WordPress的博客<em><a href="nerdzonyitoo.sinaapp.com">Nerd?Zonyitoo</a></em>，过程毫无技术含量，基本上就是点几下博客就出来了，毫无成就感。</p>

<p>再接着就是强大的师弟<strong>LPY</strong>告诉我<em><a href="github.com">github</a></em>上面可以搭博客，于是趁今天有点空就去找了一下资料，发现过程同样简单！</p>

<h1>在github在建一个博客</h1>

<h2>当然首先要有个<a href="http://github.com">github.com</a>的帐号</h2>

<ul>
<li>先登上github.com申请一个免费的帐号</li>
<li>然后在个人主页右下方点<code>New repository</code></li>
<li><p>然后它会教你怎么把一个<em>HelloWorld</em>项目上传到那个repositoriy上去，基本上就是如下步骤:</p>

<pre><code>  $ mkdir ~/Hello-World
  $ cd ~/Hello-World
  $ git init
  Initialized empty Git repository in /Users/your_name_directory/Hello-World/.git/
  $ touch README
  # 下面开始Commit
  $ git add README
  $ git commit -m 'first commit'
  # 上面这两句就是要把改变的文件记录到git里去
  # 然后上传
  $ git remote add origin git@github.com:username/Hello-World.git
  $ git push -u origin master
</code></pre>

<p>  这个时候打开你的Repository应该就能看到已经上传了的<strong>README</strong></p></li>
<li><p>这时已经学会了简单的git操作技巧，那么就可以开始搭博客了。
首先要得到SSH Public Keys</p>

<pre><code>  $ ssh-keygen -t rsa -C "your_email@youremail.com"
</code></pre></li>
</ul>


<p>然后在<code>~/.ssh/</code>下面会看见一个叫<code>id_rsa.pub</code>的文件，用VIM或GEdit打开，把里面的东西拷到github网站里：&#8221;Account Settings&#8221; >> &#8220;SSH Public Keys&#8221; >> &#8220;Add another public key&#8221;，都复制到那个框内。</p>

<blockquote><p>PS：如果是第一次的话很容易就会忽略右上角那个<strong>Add another public key</strong>，这时应该认真读一下<a href="http://help.github.com/ssh-key-passphrases/">github help</a></p></blockquote>

<ul>
<li>然后，就要建一个github pages。就是创建一个新的Repository，如果你的博客名是http://yourname.github.com，那么Repository的<em>project name</em>就<strong>必须</strong>是yourname.github.com</li>
<li>接下来可以看一下github的help页面中<a href="http://help.github.com/pages/">关于如何搭建一个github pages</a>的教程，可以简单地上传一个index.html即可！但是这太简单了&#8230;</li>
<li>不过，如果你现在已经按照help页面的方法做了的话，那么访问http://yourname.github.com就应该会看到一个大大的<strong>Hello!!</strong></li>
<li>那么，大功告成_^</li>
</ul>


<p>不过，我们是不会简单地满足于只有一个index.html页面的，反正本人是比较懒，不想自己去写一个博客网站，那太费力了，那么采用现成的博客系统就是最好的选择，现成的话我知道的比较好用的有两个：WordPress和Octopress，而Github在这两者之中只支持Octopress = =</p>

<h1>为什么要用Octopress?</h1>

<p>其实，这个我不就不用多说了，为什么不直接去<a href="http://octopress.org">Octopress的官网</a>看一看呢</p>

<h1>安装Ruby</h1>

<p>Octopress是用Ruby写的系统，所以要用它那必须得先在自己电脑上装Ruby，安装其实很简单，一般的Linux发行版的包管理器中都会有Ruby，Ubuntu中则是：</p>

<h4>用包管理器安装<strong>Ruby 1.9.2</strong></h4>

<pre><code># apt-get install ruby-1.9.1
</code></pre>

<p>要注意的是，这里必须是要装<strong>Ruby 1.9.2</strong>，但为什么命令里是1.9.1？我也不知道，apt-get里面显示最新版就只有1.9.1但是装完后用<code>ruby -v</code>查看的话会显示<code>ruby 1.9.2p290 (2011-07-09 revision 32553) [x86_64-linux]</code></p>

<blockquote><p>PS: 千万不要图省事直接<code>apt-get install ruby</code>，这样装完之后会陷入无尽的纠结之中（若你没有学过Ruby，我就是），因为它默认装的是1.8.x的版本，这是不能运行<strong>Octopress</strong>的！</p></blockquote>

<h1>安装Octopress</h1>

<ul>
<li><p>获取octopress，直接执行</p>

<pre><code>  $ git clone git://github.com/imathis/octopress.git yourblogfolder
</code></pre></li>
<li><p><code>gem install bundler</code></p></li>
<li><code>bundle install</code></li>
<li><code>rake install</code>    这一步是装默认主题</li>
</ul>


<p>至此，Octopress已经安装完毕，可以开始写日志了</p>

<h1>激动人心的一步，写日志！</h1>

<ul>
<li>在你的博客根目录处，执行`rake new_post[&#8220;my first blog&#8221;]，然后你会发现在/source/_post/下会生成一个.markdown文件，这时你就可以拿它来写日志了，写好了日志然后保存回去</li>
<li>完成之后执行<code>rake generate</code>，生成</li>
<li>执行<code>rake preview</code>可以在浏览器<a href="http://127.0.0.1:4000">这个地址</a>进行预览</li>
<li>最后执行<code>rake deploy</code>，将日志提交到github上，完成！</li>
</ul>


<h1>补充一些</h1>

<p>在第一次同步之前，要先执行</p>

<pre><code>rake setup_github_pages
</code></pre>

<p>设定github发布，然后要填入你的Git URL，就是你的Respository页里面的SSH同步地址，格式如：<code>git@github.com:yourname/yourname.github.com.git</code></p>

<h1>小结</h1>

<p>这就是我这一个晚上研究的成果，终于成功搭了一个博客，虽然自己再回去看感觉其实过程也是很简单的，都是一些操作而没有要研究的东西，只是因为是第一次很多都是摸着石头过河，没有Ruby基础是关键！</p>

<p>下一篇就来聊聊怎么配置Octopress，我还在学习中</p>

<h1>学习参考:</h1>

<ul>
<li><a href="github.com">github.com</a></li>
<li><a href="http://hopes4.me/blog/introduce-octopress-on-github/">我是清都山水郎的博文</a></li>
<li><a href="http://www.ituring.com.cn/article/details/775">图灵社区Markdown语法</a></li>
</ul>


		
		
	</div>

</article>


    <article class="post">
	<div class="meta">
		<div class="date">








  


<time datetime="2012-04-14T13:11:00+08:00" pubdate data-updated="true">Apr 14<span>th</span>, 2012</time></div>
		<div class="tags">


	<a class='category' href='/blog/categories/android/'>Android</a>


</div>
		
			<span class="comments"><a href="/blog/2012/04/14/androidyu-fu-wu-qi-jin-xing-tong-xin-de-wen-ti//index.html#disqus_thread">Comments</a></span>
		
	</div>
	<h1 class="title"><a href="/blog/2012/04/14/androidyu-fu-wu-qi-jin-xing-tong-xin-de-wen-ti/">Android与服务器进行通信的问题</a></h1>
	<div class="entry-content">
		<p>最近没有什么比较有趣而又有挑战性的项目在手，只好继续在<strong>WHJ</strong>老师的实验室里面准备搞ARM开发，唯一期待的就是准备筹建的参加全国大赛的机器人队，希望到时去面试能进！我正在怀疑我当时是不是应该选电子系而不是计算机系，毕竟现在表现得就像对底层的兴趣高于对前台开发或软件开发的兴趣。</p>

<p>题外话说多了，入正题，这次探讨的是Android与Django架构服务器之间通信中遇到的问题及我的解决方法</p>

<h1>应答字符串为JSON格式时，字符串两端会自动加上一个双引号</h1>

<p>这个题目很奇怪，让人看起来不知道是在讲什么，我们来看一个实际例子</p>

<ul>
<li>手机这边向服务器请求用户登录，发送JSON字符串为</li>
</ul>


<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="p">{</span><span class="s2">&quot;user_name&quot;</span><span class="o">:</span> <span class="nx">user_name</span><span class="p">,</span> <span class="s2">&quot;user_password&quot;</span><span class="o">:</span> <span class="nx">user_password</span><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<ul>
<li>服务器端收到的JSON字符串为</li>
</ul>


<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="s2">&quot;{&quot;</span><span class="nx">user_name</span><span class="s2">&quot;: user_name, &quot;</span><span class="nx">user_password</span><span class="s2">&quot;: user_password}&quot;</span>
</span></code></pre></td></tr></table></div></figure>


<p>反之亦然。</p>

<p>发现不同了么？对了，就是左右两端多了个引号。这个BUG非常隐秘，这两个符号足足困扰了我三天才注意到它多了这么两个符号，导致整个字符串从一个JSONObject变成了一个String类型，直接写入JSONObject的构造函数会抛出JSONException</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='java'><span class='line'><span class="n">String</span> <span class="n">responseStr</span> <span class="o">=</span> <span class="n">connection</span><span class="o">.</span><span class="na">getResponse</span><span class="o">();</span>
</span><span class='line'><span class="n">JSONTokener</span> <span class="n">tokener</span> <span class="o">=</span> <span class="k">new</span> <span class="n">JSONTokener</span><span class="o">(</span><span class="n">responseStr</span><span class="o">);</span>
</span><span class='line'><span class="n">JSONObject</span> <span class="n">jsonobj</span> <span class="o">=</span> <span class="k">new</span> <span class="n">JSONObject</span><span class="o">((</span><span class="n">String</span><span class="o">)</span> <span class="n">tokener</span><span class="o">.</span><span class="na">nextValue</span><span class="o">());</span>
</span></code></pre></td></tr></table></div></figure>


<p>当然，看到这里一般来说都会想到，直接用substring取出中间那段字符不就行了么？是的，我刚开始也是这样想的，问题是不行，JSONObject的构造函数同样会解释错误，只有这样才是对的…</p>

<p>但是，在服务器端用Python的substring却可以…非常怪异。</p>

<h1>发送密码用Base64加密的问题</h1>

<p>Android自身带有Base64加密与解密的包，可以方便地加密密码方便传输。</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='java'><span class='line'><span class="n">String</span> <span class="n">res</span> <span class="o">=</span> <span class="o">...</span>
</span><span class='line'><span class="n">String</span> <span class="n">encode_str</span> <span class="o">=</span> <span class="n">Base64</span><span class="o">.</span><span class="na">encodeToString</span><span class="o">(</span><span class="n">res</span><span class="o">.</span><span class="na">getBytes</span><span class="o">(),</span> <span class="n">Base64</span><span class="o">.</span><span class="na">DEFAULT</span><span class="o">);</span>
</span></code></pre></td></tr></table></div></figure>


<p>看起来用法与Java所带的sun.misc的<code>Base64Encoder</code>这些用法差不多，但应该留意到了，在encode的时候，会有一个参数Flags（即上面代码中的<code>Base64.DEFAULT</code>）</p>

<p>这个参数有什么用呢？根据Android SDK的描述，这种参数有5个：</p>

<blockquote><ol>
<li>CRLF 这个参数看起来比较眼熟，它就是Win风格的换行符，意思就是使用CR LF这一对作为一行的结尾而不是Unix风格的LF</li>
<li>DEFAULT 这个参数是默认，使用默认的方法来加密</li>
<li>NO_PADDING 这个参数是略去加密字符串最后的”=”</li>
<li>NO_WRAP 这个参数意思是略去所有的换行符（设置后CRLF就没用了）</li>
<li>URL_SAFE 这个参数意思是加密时不使用对URL和文件名有特殊意义的字符来作为加密字符，具体就是以-和_取代+和/</li>
</ol>
</blockquote>

<p>若用<code>Base64.DEFAULT</code>发送服务器不能识别，则应该选用<code>Base64.NO_WRAP | Baser64.URL_SAFE</code>来加密</p>

<blockquote><p>例如原字符串为：QUFodH?????</p>

<p>用DEFAULT加密后为：UVVGb2RIPz8/Pz8=</p>

<p>用NO_WRAP | URL_SAFE加密后为：UVVGb2RIPz8_Pz8=</p>

<p>用sun.misc.BASE64Encoder加密后为：UVVGb2RIPz8/Pz8=</p></blockquote>

<p>由上面例子可以清楚见到，<code>DEFAULT</code>加密方式出现了/这个URL中会比较敏感的字符，而<code>URL_SAFE</code>方法加密则不会出现</p>

		
		
	</div>

</article>

<nav id="pagenavi">
    
    
    <div class="center"><a href="/blog/archives">Blog Archives</a></div>
</nav></div>
			</div>
			<footer id="footer" class="inner">Copyright &copy; 2012

    Yutang Chung


Design credit: <a href="http://shashankmehta.in/archive/2012/greyshade.html">Shashank Mehta</a></footer>
			<script src="/javascripts/slash.js"></script>
<script src="/javascripts/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
(function($){
	$('.fancybox').fancybox();
})(jQuery);
</script> <!-- Delete or comment this line to disable Fancybox -->


<script type="text/javascript">
      var disqus_shortname = 'sysuzonyitooblog';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>



	<script type="text/javascript">
		var _gaq = _gaq || [];
		_gaq.push(['_setAccount', 'UA-36473925-1']);
		_gaq.push(['_trackPageview']);

		(function() {
			var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
			ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
			var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
		})();
	</script>



		</div>
	</div>
</body>
</html>
